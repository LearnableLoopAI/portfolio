<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Portfolio Management with Deep Reinforcement Learning | Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Portfolio Management with Deep Reinforcement Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<meta property="og:description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<meta property="og:site_name" content="Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData" />
<meta property="og:image" content="/portfolio/images/PortfolioManagement.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-11T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"/portfolio/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html","@type":"BlogPosting","headline":"Portfolio Management with Deep Reinforcement Learning","dateModified":"2021-11-11T00:00:00-06:00","datePublished":"2021-11-11T00:00:00-06:00","image":"/portfolio/images/PortfolioManagement.png","mainEntityOfPage":{"@type":"WebPage","@id":"/portfolio/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html"},"description":"DRL is used to provide dynamic asset allocation for a portfolio","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/portfolio/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/portfolio/feed.xml" title="Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7YVR807GNV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7YVR807GNV');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/portfolio/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/portfolio/">Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/portfolio/about/">About Me</a><a class="page-link" href="/portfolio/search/">Search</a><a class="page-link" href="/portfolio/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Portfolio Management with Deep Reinforcement Learning</h1><p class="page-description">DRL is used to provide dynamic asset allocation for a portfolio</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-11T00:00:00-06:00" itemprop="datePublished">
        Nov 11, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      41 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/portfolio/categories/#Investment_Industry">Investment_Industry</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#Reinforcement_Learning">Reinforcement_Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#A2C">A2C</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#PPO">PPO</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#OpenAI">OpenAI</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#Gym">Gym</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#finrl">finrl</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#stable_baselines3">stable_baselines3</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio/categories/#pyfolio">pyfolio</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#1.-Problem:-Dynamic-Asset-Allocation">1. Problem: Dynamic Asset Allocation </a></li>
<li class="toc-entry toc-h2"><a href="#2.-Solution-Proposal">2. Solution Proposal </a></li>
<li class="toc-entry toc-h2"><a href="#3.-Implementation-of-the-Solution">3. Implementation of the Solution </a>
<ul>
<li class="toc-entry toc-h3"><a href="#3.0-PARAMETERS">3.0 PARAMETERS </a></li>
<li class="toc-entry toc-h3"><a href="#3.1-Download-Data">3.1 Download Data </a></li>
<li class="toc-entry toc-h3"><a href="#3.2-Data-Understanding-and-Preparation">3.2 Data Understanding and Preparation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.2.1-Add-technical-indicators">3.2.1 Add technical indicators </a></li>
<li class="toc-entry toc-h4"><a href="#3.2.2-Add-covariance-matrix-as-a-feature">3.2.2 Add covariance matrix as a feature </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.3-Modeling">3.3 Modeling </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.3.1-Training-data">3.3.1 Training data </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.2-Portfolio-(Environment)">3.3.2 Portfolio (Environment) </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.3-Portfolio-Manager-(Agent)">3.3.3 Portfolio Manager (Agent) </a>
<ul>
<li class="toc-entry toc-h5"><a href="#3.3.3.1-A2C">3.3.3.1 A2C </a></li>
<li class="toc-entry toc-h5"><a href="#3.3.3.2-PPO">3.3.3.2 PPO </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.4-Evaluation">3.4 Evaluation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.4.1-Inspect-actions">3.4.1 Inspect actions </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.2-Inspect-daily-return">3.4.2 Inspect daily return </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.3-Inspect-cumulative-return">3.4.3 Inspect cumulative return </a></li>
</ul>
</li>
</ul>
</li>
</ul><body>
<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-11-PortfolioManagement.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Problem:-Dynamic-Asset-Allocation">
<a class="anchor" href="#1.-Problem:-Dynamic-Asset-Allocation" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Problem: Dynamic Asset Allocation<a class="anchor-link" href="#1.-Problem:-Dynamic-Asset-Allocation"> </a>
</h2>
<p><em>Asset allocation</em> refers to the partitioning of available funds in a portfolio among various investment products. Investment products may be categorized in multiple ways. One common (and high level) classification contains three classes:</p>
<ul>
<li>Stocks</li>
<li>Bonds (fixed income)</li>
<li>Cash and cash equivalents</li>
</ul>
<p>Other classification systems may sub-classify each of these categories into subclasses, for example stocks into US and International stocks, or into small-cap, medium-cap, and large-cap stocks, etc.</p>
<p>Another aspect of asset allocation is concerns the underlying <em>strategy</em>. Some strategies are:</p>
<ul>
<li>Tactical asset allocation</li>
<li>Strategic asset allocation</li>
<li>Constant weight asset allocation</li>
<li>Integrated asset allocation</li>
<li>Insured asset allocation</li>
<li>Dynamic asset allocation</li>
</ul>
<p>We will focus on the last of these strategies: Dynamic asset allocation. With this approach the combination of assets are adjusted at regular intervals to capitalize on the strengthening and weakening of the economy and rise and fall of markets. This strategy depends on the decisions of a portfolio manager. In this project, however, we will attempt to replace the portfolio manager with an <em>AI agent</em>. The agent will be trained on past market behavior by means of <em>Deep Reinforcement Learning</em>.</p>
<p>For this Proof-Of-Concept (POC) project we will make things as simple as possible. The portfolio will consist of the 30 investment products in the Dow-Jones (DJIA). The fixed allocation in the DJIA also provides a handy reference against which the performance of our agent's dynamic behavior can be juxtaposed. Our agent will have the opportunity to adjust the mix of stocks on a daily basis. In practice, a 401K agent, for example, might be setup to make monthly adjustments to reduce transation costs or to avoid constraints related to trading. For simplicity, trading costs will not be taken into account for now.</p>
<p>Our agent will have $ 1,000,000 when the project starts.</p>
<p>To implement this POC we will make use of the FinRL framework as well as some Yahoo technology to acquire financial data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Solution-Proposal">
<a class="anchor" href="#2.-Solution-Proposal" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Solution Proposal<a class="anchor-link" href="#2.-Solution-Proposal"> </a>
</h2>
<p>Investment decisions are sequential by nature. Furthermore, an optimal decision in the present may turn out not to be optimal over the longer term. Then there are the complexities of the investment landscape like varying market conditions, political disruptive event, and other economic uncertainties. The ideal tool for this kind of problem is <strong>Reinforcement Learning</strong>.</p>
<p>The solution requires the setup of a <strong>digital twin</strong> for the investor's portfolio. In RL parlance this model of the portfolio is called an <strong>environment</strong>. The environment contains <strong>states</strong> which are modified by applying <strong>actions</strong> to it.</p>
<p>We will choose the following <strong>states</strong> (measured daily in our case) for the environment:</p>
$$ 
\begin{align}
&amp; s_1=\text{Value of AAPL holdings} \\
&amp; s_2=\text{Value of AMGN holdings} \\
&amp; s_3=\text{Value of AXP holdings} \\
&amp; \text{...} \\
&amp; s_{29}=\text{Value of WBA holdings} \\
&amp; s_{30}=\text{Value of WMT holdings} \\
\end{align}
$$<p>The following <strong>actions</strong> (applied daily in our case) will be setup to influence the environment/portfolio:</p>
$$ 
\begin{align}
&amp; a_1=\text{Fraction to be invested in AAPL this cycle} \\
&amp; a_2=\text{Fraction to be invested in AMGN this cycle} \\
&amp; a_3=\text{Fraction to be invested in AXP this cycle} \\
&amp; \text{...} \\
&amp; a_{29}=\text{Fraction to be invested in WBA this cycle} \\
&amp; a_{30}=\text{Fraction to be invested in WMT this cycle} \\
\end{align}
$$<p>All action values are in the [0, 1] interval.</p>
<p>The <em>reward</em> $r$ is given by</p>
$$
\begin{align}
r(s,a,s')=log(v'/v)
\end{align}
$$<p>where $v$ and $v'$ are the portfolio value at states $s'$ and $s$ respectively.</p>
<p>The model of the portfolio/environment will have the following <strong>parameters</strong>:</p>
$$ 
\begin{align}
&amp; \theta_1=\text{Initial Amount} \\
&amp; \theta_2=\text{Transaction Cost Pct} \\
&amp; \theta_3=\text{Size of State and Action Spaces} \\
&amp; \theta_4=\text{Reward Scaling} \\
&amp; \theta_5=\text{Technical Indicator List} \\
\end{align}
$$<p>Rather than having the investor's salary directly as a parameter, we will have two parameters, one for the low value and one for the high value. This makes the model more flexible, in particular during training. The same applies for the two parameters used for the house price. In addition, we will add some variability for the interest rates. The latter variabilities may be considered <em>disturbances</em> experienced by the investor. The agent has the ability to incorporate such disturbances during its operation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Implementation-of-the-Solution">
<a class="anchor" href="#3.-Implementation-of-the-Solution" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Implementation of the Solution<a class="anchor-link" href="#3.-Implementation-of-the-Solution"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To implement the <em>environment</em> we use the OpenAI Gym tools. We will use the FinRL python library to implement the <em>agent</em>. For a function approximator for the agent, two algorithms will be investigated:</p>
<ul>
<li>Advantage Actor-Critic (A2C)</li>
<li>Proximal Policy Optimization (PPO)</li>
</ul>
<p>This implementation allows the agent to allocate the investor's funds between the 30 DJIA  instruments. The goal is to maximize net worth at the end of the investment horizon.</p>
<p>The plotly library will be used for visualization. The code will run on the Google Colab platform. To start with, we install the python packages needed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import the packages needed:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'Agg'</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">finrl.apps</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.yahoodownloader</span> <span class="kn">import</span> <span class="n">YahooDownloader</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.preprocessors</span> <span class="kn">import</span> <span class="n">FeatureEngineer</span><span class="p">,</span> <span class="n">data_split</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.env_portfolio_allocation.env_portfolio</span> <span class="kn">import</span> <span class="n">StockPortfolioEnv</span>
<span class="kn">from</span> <span class="nn">finrl.drl_agents.stablebaselines3.models</span> <span class="kn">import</span> <span class="n">DRLAgent</span>
<span class="kn">from</span> <span class="nn">finrl.plot</span> <span class="kn">import</span> <span class="n">backtest_stats</span><span class="p">,</span> <span class="n">backtest_plot</span><span class="p">,</span> <span class="n">get_daily_return</span><span class="p">,</span> <span class="n">get_baseline</span><span class="p">,</span><span class="n">convert_daily_return_to_pyfolio_ts</span>

<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">gym.utils</span> <span class="kn">import</span> <span class="n">seeding</span>
<span class="kn">from</span> <span class="nn">gym</span> <span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">DummyVecEnv</span>

<span class="kn">from</span> <span class="nn">pyfolio</span> <span class="kn">import</span> <span class="n">timeseries</span>
<span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pyfolio/pos.py:27: UserWarning: Module "zipline.assets" not found; multipliers will not be applied to position notionals.
  'Module "zipline.assets" not found; multipliers will not be applied'
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"../FinRL-Library"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Setup some directories:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.0-PARAMETERS">
<a class="anchor" href="#3.0-PARAMETERS" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.0 PARAMETERS<a class="anchor-link" href="#3.0-PARAMETERS"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA_START</span> <span class="o">=</span> <span class="s1">'2008-01-01'</span> 
<span class="n">TRAIN_START</span> <span class="o">=</span> <span class="s1">'2009-01-01'</span>
<span class="n">TRADE_START</span> <span class="o">=</span> <span class="s1">'2020-07-01'</span>
<span class="n">DATA_END</span> <span class="o">=</span> <span class="s1">'2021-09-02'</span>
<span class="n">LOOKBACK</span> <span class="o">=</span> <span class="mi">252</span> <span class="c1">#trading days in one year</span>
<span class="n">INITIAL_AMOUNT</span> <span class="o">=</span> <span class="mi">1_000_000</span> <span class="c1">#dollars</span>
<span class="n">TRANSACTION_COST_PCT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">REWARD_SCALING</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="c1">#scaling factor applied to the reward signal</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1-Download-Data">
<a class="anchor" href="#3.1-Download-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 Download Data<a class="anchor-link" href="#3.1-Download-Data"> </a>
</h3>
<p>We use the data from Yahoo Finance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">YahooDownloader</span><span class="p">(</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">DATA_START</span><span class="p">,</span>
                     <span class="n">end_date</span> <span class="o">=</span> <span class="n">DATA_END</span><span class="p">,</span>
                     <span class="n">ticker_list</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">DOW_30_TICKER</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (100385, 8)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337456</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694550</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481632</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633057</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>100380</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
    </tr>
    <tr>
      <th>100381</th>
      <td>2021-09-01</td>
      <td>229.100006</td>
      <td>230.779999</td>
      <td>228.770004</td>
      <td>229.715607</td>
      <td>8177600</td>
      <td>V</td>
      <td>2</td>
    </tr>
    <tr>
      <th>100382</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
    </tr>
    <tr>
      <th>100383</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>100384</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>100385 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Verify 30 unique tickers</span>
<span class="c1"># https://www.investopedia.com/ask/answers/who-or-what-is-dow-jones/</span>
<span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'tic'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">lst</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>30 ['AAPL', 'AMGN', 'AXP', 'BA', 'CAT', 'CRM', 'CSCO', 'CVX', 'DIS', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'JPM', 'KO', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'VZ', 'WBA', 'WMT', 'V', 'DOW']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.2-Data-Understanding-and-Preparation">
<a class="anchor" href="#3.2-Data-Understanding-and-Preparation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 Data Understanding and Preparation<a class="anchor-link" href="#3.2-Data-Understanding-and-Preparation"> </a>
</h3>
<p>We will keep showing snippets of the data set as it evolves to assist with understanding. There is a need to check for missing data and also to do some feature engineering. We rely on the FeatureEngineer class to take care of these needs. Some indicators used are:</p>
<ul>
<li>Moving Average Convergence Divergence (MACD)</li>
</ul>
<p>The MACD is primarily used to gauge the strength of stock price movement. It does this by measuring the divergence of two exponential moving averages (EMAs), commonly a 12-period EMA and a 26-period EMA.</p>
<ul>
<li>Relative Strength Index (RSI)</li>
</ul>
<p>The RSI aims to indicate whether a market is considered to be overbought or oversold in relation to recent price levels.</p>
<ul>
<li>Commodity Channel Index (CCI)
The Commodity Channel Index​ (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.</li>
</ul>
<p>FinRL also uses the financial turbulence index that measures extreme asset price fluctuation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.1-Add-technical-indicators">
<a class="anchor" href="#3.2.1-Add-technical-indicators" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.1 Add technical indicators<a class="anchor-link" href="#3.2.1-Add-technical-indicators"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">FeatureEngineer</span><span class="p">(</span>
  <span class="n">use_technical_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">use_turbulence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">user_defined_feature</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Successfully added technical indicators
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>3442</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337456</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337456</td>
      <td>36.337456</td>
    </tr>
    <tr>
      <th>6884</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694550</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694550</td>
      <td>40.694550</td>
    </tr>
    <tr>
      <th>10326</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481632</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481632</td>
      <td>63.481632</td>
    </tr>
    <tr>
      <th>13768</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633057</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633057</td>
      <td>47.633057</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82607</th>
      <td>2021-09-01</td>
      <td>159.429993</td>
      <td>160.229996</td>
      <td>158.210007</td>
      <td>158.397003</td>
      <td>1133800</td>
      <td>TRV</td>
      <td>2</td>
      <td>2.126652</td>
      <td>163.483054</td>
      <td>150.694548</td>
      <td>55.446787</td>
      <td>62.496692</td>
      <td>22.987009</td>
      <td>154.028030</td>
      <td>152.401430</td>
    </tr>
    <tr>
      <th>86049</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
      <td>1.544983</td>
      <td>428.508670</td>
      <td>402.801383</td>
      <td>53.065126</td>
      <td>-4.030115</td>
      <td>15.845681</td>
      <td>415.105289</td>
      <td>409.407493</td>
    </tr>
    <tr>
      <th>89491</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.246229</td>
      <td>55.496104</td>
      <td>53.821636</td>
      <td>44.243162</td>
      <td>-102.777095</td>
      <td>25.659221</td>
      <td>54.825886</td>
      <td>55.061444</td>
    </tr>
    <tr>
      <th>92933</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
      <td>0.490625</td>
      <td>50.485316</td>
      <td>46.328237</td>
      <td>54.782463</td>
      <td>155.821606</td>
      <td>20.132924</td>
      <td>47.760327</td>
      <td>48.719896</td>
    </tr>
    <tr>
      <th>96375</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
      <td>1.245131</td>
      <td>152.373761</td>
      <td>144.501761</td>
      <td>57.098500</td>
      <td>21.764207</td>
      <td>7.619276</td>
      <td>146.274390</td>
      <td>142.551757</td>
    </tr>
  </tbody>
</table>
<p>96376 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the FeatureEngineer has added some features:</p>
<ul>
<li>macd</li>
<li>boll_ub (upper Bollinger Band)</li>
<li>boll_lb (lower Bollinger Band)</li>
<li>rsi_30 (with a lookback of 30)</li>
<li>cci_30 (with a lookback of 30)</li>
<li>dx_30 (with a lookback of 30)</li>
<li>close_30_sma (close price simple moving average with a lookback of 30)</li>
<li>close_60_sma (close price simple moving average with a lookback of 60)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.2-Add-covariance-matrix-as-a-feature">
<a class="anchor" href="#3.2.2-Add-covariance-matrix-as-a-feature" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.2 Add covariance matrix as a feature<a class="anchor-link" href="#3.2.2-Add-covariance-matrix-as-a-feature"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding the portfolio's covariance matrix as a feature has some advantages. It can be used to quantify the risk (standard deviation) associated with a portfolio.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337456</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337456</td>
      <td>36.337456</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694550</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694550</td>
      <td>40.694550</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481632</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481632</td>
      <td>63.481632</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633057</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633057</td>
      <td>47.633057</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96371</th>
      <td>2021-09-01</td>
      <td>159.429993</td>
      <td>160.229996</td>
      <td>158.210007</td>
      <td>158.397003</td>
      <td>1133800</td>
      <td>TRV</td>
      <td>2</td>
      <td>2.126652</td>
      <td>163.483054</td>
      <td>150.694548</td>
      <td>55.446787</td>
      <td>62.496692</td>
      <td>22.987009</td>
      <td>154.028030</td>
      <td>152.401430</td>
    </tr>
    <tr>
      <th>96372</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
      <td>1.544983</td>
      <td>428.508670</td>
      <td>402.801383</td>
      <td>53.065126</td>
      <td>-4.030115</td>
      <td>15.845681</td>
      <td>415.105289</td>
      <td>409.407493</td>
    </tr>
    <tr>
      <th>96373</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.246229</td>
      <td>55.496104</td>
      <td>53.821636</td>
      <td>44.243162</td>
      <td>-102.777095</td>
      <td>25.659221</td>
      <td>54.825886</td>
      <td>55.061444</td>
    </tr>
    <tr>
      <th>96374</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
      <td>0.490625</td>
      <td>50.485316</td>
      <td>46.328237</td>
      <td>54.782463</td>
      <td>155.821606</td>
      <td>20.132924</td>
      <td>47.760327</td>
      <td>48.719896</td>
    </tr>
    <tr>
      <th>96375</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
      <td>1.245131</td>
      <td>152.373761</td>
      <td>144.501761</td>
      <td>57.098500</td>
      <td>21.764207</td>
      <td>7.619276</td>
      <td>146.274390</td>
      <td>142.551757</td>
    </tr>
  </tbody>
</table>
<p>96376 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">factorize</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#. now each new date has a new index</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337456</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337456</td>
      <td>36.337456</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694550</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694550</td>
      <td>40.694550</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481632</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481632</td>
      <td>63.481632</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633057</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971309</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633057</td>
      <td>47.633057</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2021-09-01</td>
      <td>159.429993</td>
      <td>160.229996</td>
      <td>158.210007</td>
      <td>158.397003</td>
      <td>1133800</td>
      <td>TRV</td>
      <td>2</td>
      <td>2.126652</td>
      <td>163.483054</td>
      <td>150.694548</td>
      <td>55.446787</td>
      <td>62.496692</td>
      <td>22.987009</td>
      <td>154.028030</td>
      <td>152.401430</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
      <td>1.544983</td>
      <td>428.508670</td>
      <td>402.801383</td>
      <td>53.065126</td>
      <td>-4.030115</td>
      <td>15.845681</td>
      <td>415.105289</td>
      <td>409.407493</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.246229</td>
      <td>55.496104</td>
      <td>53.821636</td>
      <td>44.243162</td>
      <td>-102.777095</td>
      <td>25.659221</td>
      <td>54.825886</td>
      <td>55.061444</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
      <td>0.490625</td>
      <td>50.485316</td>
      <td>46.328237</td>
      <td>54.782463</td>
      <td>155.821606</td>
      <td>20.132924</td>
      <td>47.760327</td>
      <td>48.719896</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
      <td>1.245131</td>
      <td>152.373761</td>
      <td>144.501761</td>
      <td>57.098500</td>
      <td>21.764207</td>
      <td>7.619276</td>
      <td>146.274390</td>
      <td>142.551757</td>
    </tr>
  </tbody>
</table>
<p>96376 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">cov_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">LOOKBACK</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())):</span>
  <span class="n">data_lookback</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">LOOKBACK</span><span class="p">:</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
  <span class="n">price_lookback</span> <span class="o">=</span> <span class="n">data_lookback</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'date'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'tic'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'close'</span><span class="p">)</span>
  <span class="n">return_lookback</span> <span class="o">=</span> <span class="n">price_lookback</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
  <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">return_lookback</span><span class="p">)</span>
  <span class="n">covs</span> <span class="o">=</span> <span class="n">return_lookback</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> 
  <span class="n">cov_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">covs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 23s, sys: 1min 10s, total: 2min 34s
Wall time: 1min 19s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3442, 3190)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cov_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3190, 3190)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># form a dataframe with the cov_list and return_list</span>
<span class="n">df_cov</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:],</span> <span class="s1">'cov_list'</span><span class="p">:</span><span class="n">cov_list</span><span class="p">,</span> <span class="s1">'return_list'</span><span class="p">:</span><span class="n">return_list</span><span class="p">})</span>
<span class="n">df_cov</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-02</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-05</td>
      <td>[[0.0013520199451860352, 0.0004294713932227298...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-06</td>
      <td>[[0.0013523434523507877, 0.0004313717163616539...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-07</td>
      <td>[[0.001349260814510138, 0.00043429999408710015...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3185</th>
      <td>2021-08-26</td>
      <td>[[0.0003928453300803985, 9.896438258199282e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3186</th>
      <td>2021-08-27</td>
      <td>[[0.0003923489896636871, 9.967088913301946e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3187</th>
      <td>2021-08-30</td>
      <td>[[0.000395776633559146, 0.00010042885429991909...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3188</th>
      <td>2021-08-31</td>
      <td>[[0.0003917984085520445, 0.0001000497334010198...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3189</th>
      <td>2021-09-01</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>3190 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge df_cov with the main dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cov</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'date'</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>3.070357</td>
      <td>3.133571</td>
      <td>3.047857</td>
      <td>2.613433</td>
      <td>607541200</td>
      <td>AAPL</td>
      <td>2</td>
      <td>-0.083547</td>
      <td>3.128999</td>
      <td>2.482334</td>
      <td>42.254781</td>
      <td>-80.488215</td>
      <td>16.129793</td>
      <td>2.780976</td>
      <td>2.894368</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>57.110001</td>
      <td>58.220001</td>
      <td>57.060001</td>
      <td>45.031933</td>
      <td>6287200</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.168717</td>
      <td>45.965627</td>
      <td>43.970344</td>
      <td>51.060623</td>
      <td>51.616207</td>
      <td>10.432018</td>
      <td>44.190812</td>
      <td>43.701895</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>17.969999</td>
      <td>18.750000</td>
      <td>17.910000</td>
      <td>14.988312</td>
      <td>9625600</td>
      <td>AXP</td>
      <td>2</td>
      <td>-0.961734</td>
      <td>19.168084</td>
      <td>13.014357</td>
      <td>42.554864</td>
      <td>-75.368734</td>
      <td>25.776759</td>
      <td>16.184140</td>
      <td>18.108784</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>41.590000</td>
      <td>43.049999</td>
      <td>41.500000</td>
      <td>32.005878</td>
      <td>5443100</td>
      <td>BA</td>
      <td>2</td>
      <td>-0.279801</td>
      <td>32.174382</td>
      <td>28.867831</td>
      <td>47.440223</td>
      <td>156.994494</td>
      <td>5.366299</td>
      <td>30.327212</td>
      <td>32.389915</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>43.700001</td>
      <td>45.099998</td>
      <td>43.700001</td>
      <td>30.925043</td>
      <td>6277400</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.684759</td>
      <td>31.697350</td>
      <td>26.587392</td>
      <td>51.205311</td>
      <td>98.425695</td>
      <td>26.331746</td>
      <td>27.876155</td>
      <td>27.598371</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>89315</th>
      <td>2021-09-01</td>
      <td>159.429993</td>
      <td>160.229996</td>
      <td>158.210007</td>
      <td>158.397003</td>
      <td>1133800</td>
      <td>TRV</td>
      <td>2</td>
      <td>2.126652</td>
      <td>163.483054</td>
      <td>150.694548</td>
      <td>55.446787</td>
      <td>62.496692</td>
      <td>22.987009</td>
      <td>154.028030</td>
      <td>152.401430</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89316</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
      <td>1.544983</td>
      <td>428.508670</td>
      <td>402.801383</td>
      <td>53.065126</td>
      <td>-4.030115</td>
      <td>15.845681</td>
      <td>415.105289</td>
      <td>409.407493</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89317</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.246229</td>
      <td>55.496104</td>
      <td>53.821636</td>
      <td>44.243162</td>
      <td>-102.777095</td>
      <td>25.659221</td>
      <td>54.825886</td>
      <td>55.061444</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89318</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
      <td>0.490625</td>
      <td>50.485316</td>
      <td>46.328237</td>
      <td>54.782463</td>
      <td>155.821606</td>
      <td>20.132924</td>
      <td>47.760327</td>
      <td>48.719896</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89319</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
      <td>1.245131</td>
      <td>152.373761</td>
      <td>144.501761</td>
      <td>57.098500</td>
      <td>21.764207</td>
      <td>7.619276</td>
      <td>146.274390</td>
      <td>142.551757</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>89320 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>3.070357</td>
      <td>3.133571</td>
      <td>3.047857</td>
      <td>2.613433</td>
      <td>607541200</td>
      <td>AAPL</td>
      <td>2</td>
      <td>-0.083547</td>
      <td>3.128999</td>
      <td>2.482334</td>
      <td>42.254781</td>
      <td>-80.488215</td>
      <td>16.129793</td>
      <td>2.780976</td>
      <td>2.894368</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>57.110001</td>
      <td>58.220001</td>
      <td>57.060001</td>
      <td>45.031933</td>
      <td>6287200</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.168717</td>
      <td>45.965627</td>
      <td>43.970344</td>
      <td>51.060623</td>
      <td>51.616207</td>
      <td>10.432018</td>
      <td>44.190812</td>
      <td>43.701895</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>17.969999</td>
      <td>18.750000</td>
      <td>17.910000</td>
      <td>14.988312</td>
      <td>9625600</td>
      <td>AXP</td>
      <td>2</td>
      <td>-0.961734</td>
      <td>19.168084</td>
      <td>13.014357</td>
      <td>42.554864</td>
      <td>-75.368734</td>
      <td>25.776759</td>
      <td>16.184140</td>
      <td>18.108784</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>41.590000</td>
      <td>43.049999</td>
      <td>41.500000</td>
      <td>32.005878</td>
      <td>5443100</td>
      <td>BA</td>
      <td>2</td>
      <td>-0.279801</td>
      <td>32.174382</td>
      <td>28.867831</td>
      <td>47.440223</td>
      <td>156.994494</td>
      <td>5.366299</td>
      <td>30.327212</td>
      <td>32.389915</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>43.700001</td>
      <td>45.099998</td>
      <td>43.700001</td>
      <td>30.925043</td>
      <td>6277400</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.684759</td>
      <td>31.697350</td>
      <td>26.587392</td>
      <td>51.205311</td>
      <td>98.425695</td>
      <td>26.331746</td>
      <td>27.876155</td>
      <td>27.598371</td>
      <td>[[0.00134896721940808, 0.0004284132636499008, ...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>89315</th>
      <td>2021-09-01</td>
      <td>159.429993</td>
      <td>160.229996</td>
      <td>158.210007</td>
      <td>158.397003</td>
      <td>1133800</td>
      <td>TRV</td>
      <td>2</td>
      <td>2.126652</td>
      <td>163.483054</td>
      <td>150.694548</td>
      <td>55.446787</td>
      <td>62.496692</td>
      <td>22.987009</td>
      <td>154.028030</td>
      <td>152.401430</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89316</th>
      <td>2021-09-01</td>
      <td>416.540009</td>
      <td>419.869995</td>
      <td>411.239990</td>
      <td>415.890198</td>
      <td>2034400</td>
      <td>UNH</td>
      <td>2</td>
      <td>1.544983</td>
      <td>428.508670</td>
      <td>402.801383</td>
      <td>53.065126</td>
      <td>-4.030115</td>
      <td>15.845681</td>
      <td>415.105289</td>
      <td>409.407493</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89317</th>
      <td>2021-09-01</td>
      <td>55.000000</td>
      <td>55.150002</td>
      <td>54.799999</td>
      <td>54.295189</td>
      <td>12647300</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.246229</td>
      <td>55.496104</td>
      <td>53.821636</td>
      <td>44.243162</td>
      <td>-102.777095</td>
      <td>25.659221</td>
      <td>54.825886</td>
      <td>55.061444</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89318</th>
      <td>2021-09-01</td>
      <td>50.730000</td>
      <td>50.810001</td>
      <td>49.480000</td>
      <td>50.290001</td>
      <td>5212400</td>
      <td>WBA</td>
      <td>2</td>
      <td>0.490625</td>
      <td>50.485316</td>
      <td>46.328237</td>
      <td>54.782463</td>
      <td>155.821606</td>
      <td>20.132924</td>
      <td>47.760327</td>
      <td>48.719896</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>89319</th>
      <td>2021-09-01</td>
      <td>147.559998</td>
      <td>147.929993</td>
      <td>146.570007</td>
      <td>147.779999</td>
      <td>6352200</td>
      <td>WMT</td>
      <td>2</td>
      <td>1.245131</td>
      <td>152.373761</td>
      <td>144.501761</td>
      <td>57.098500</td>
      <td>21.764207</td>
      <td>7.619276</td>
      <td>146.274390</td>
      <td>142.551757</td>
      <td>[[0.00038578149289071194, 0.000101384676644404...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>89320 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.3-Modeling">
<a class="anchor" href="#3.3-Modeling" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 Modeling<a class="anchor-link" href="#3.3-Modeling"> </a>
</h3>
<p>The portfolio within the market will be modeled by the OpenAI Gym framework. This is referred to as the <em>environment</em>. For the <em>agent</em>, we will use the FinRL framework. As the agent interacts with the environment it will gradually learn a trading strategy based on the reward function. The agent is rewarded according to the total value of the portfolio.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.1-Training-data">
<a class="anchor" href="#3.3.1-Training-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.1 Training data<a class="anchor-link" href="#3.3.1-Training-data"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>('2009-01-01', '2020-06-30')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">)</span>
<span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>3.067143</td>
      <td>3.251429</td>
      <td>3.041429</td>
      <td>2.778781</td>
      <td>746015200</td>
      <td>AAPL</td>
      <td>4</td>
      <td>-0.070954</td>
      <td>3.115322</td>
      <td>2.480241</td>
      <td>45.440189</td>
      <td>-32.098565</td>
      <td>2.140064</td>
      <td>2.781833</td>
      <td>2.895179</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>58.590000</td>
      <td>59.080002</td>
      <td>57.750000</td>
      <td>45.998848</td>
      <td>6547900</td>
      <td>AMGN</td>
      <td>4</td>
      <td>0.249877</td>
      <td>46.122330</td>
      <td>43.932167</td>
      <td>52.756857</td>
      <td>93.201882</td>
      <td>0.814217</td>
      <td>44.259692</td>
      <td>43.796767</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>18.570000</td>
      <td>19.520000</td>
      <td>18.400000</td>
      <td>15.618539</td>
      <td>10955700</td>
      <td>AXP</td>
      <td>4</td>
      <td>-0.855306</td>
      <td>18.979336</td>
      <td>12.997873</td>
      <td>43.957549</td>
      <td>-42.761378</td>
      <td>16.335101</td>
      <td>16.182793</td>
      <td>17.988662</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>42.799999</td>
      <td>45.560001</td>
      <td>42.779999</td>
      <td>33.941086</td>
      <td>7010200</td>
      <td>BA</td>
      <td>4</td>
      <td>-0.002010</td>
      <td>32.948623</td>
      <td>28.452128</td>
      <td>50.822019</td>
      <td>272.812545</td>
      <td>20.494464</td>
      <td>30.469477</td>
      <td>32.344131</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>44.910000</td>
      <td>46.980000</td>
      <td>44.709999</td>
      <td>32.475796</td>
      <td>7117200</td>
      <td>CAT</td>
      <td>4</td>
      <td>0.870226</td>
      <td>32.221773</td>
      <td>26.565579</td>
      <td>53.661249</td>
      <td>129.733673</td>
      <td>34.637448</td>
      <td>28.123536</td>
      <td>27.598979</td>
      <td>[[0.0013661487263709707, 0.0004339387269211268...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-06-29</td>
      <td>112.389999</td>
      <td>113.419998</td>
      <td>110.889999</td>
      <td>109.515297</td>
      <td>1161200</td>
      <td>TRV</td>
      <td>0</td>
      <td>1.979405</td>
      <td>121.852482</td>
      <td>103.617419</td>
      <td>52.214112</td>
      <td>11.966602</td>
      <td>5.469698</td>
      <td>107.830948</td>
      <td>101.884511</td>
      <td>[[0.0006532274198047049, 0.0004064266826074971...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-06-29</td>
      <td>288.450012</td>
      <td>292.279999</td>
      <td>286.619995</td>
      <td>284.474396</td>
      <td>2356700</td>
      <td>UNH</td>
      <td>0</td>
      <td>-0.260890</td>
      <td>306.917214</td>
      <td>272.829835</td>
      <td>50.851001</td>
      <td>-60.105349</td>
      <td>8.757684</td>
      <td>289.721983</td>
      <td>281.664996</td>
      <td>[[0.0006532274198047049, 0.0004064266826074971...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-06-29</td>
      <td>53.310001</td>
      <td>54.709999</td>
      <td>53.310001</td>
      <td>51.192635</td>
      <td>15930300</td>
      <td>VZ</td>
      <td>0</td>
      <td>-0.479121</td>
      <td>55.253466</td>
      <td>50.014836</td>
      <td>46.997136</td>
      <td>-94.749134</td>
      <td>16.640620</td>
      <td>52.273772</td>
      <td>52.703160</td>
      <td>[[0.0006532274198047049, 0.0004064266826074971...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-06-29</td>
      <td>41.439999</td>
      <td>42.639999</td>
      <td>41.380001</td>
      <td>40.211544</td>
      <td>5225900</td>
      <td>WBA</td>
      <td>0</td>
      <td>-0.100693</td>
      <td>44.020085</td>
      <td>37.703802</td>
      <td>48.712778</td>
      <td>-17.069637</td>
      <td>1.500723</td>
      <td>40.317714</td>
      <td>40.140577</td>
      <td>[[0.0006532274198047049, 0.0004064266826074971...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-06-29</td>
      <td>118.500000</td>
      <td>119.680000</td>
      <td>118.220001</td>
      <td>116.759590</td>
      <td>5503800</td>
      <td>WMT</td>
      <td>0</td>
      <td>-0.962287</td>
      <td>121.476836</td>
      <td>114.611734</td>
      <td>47.147251</td>
      <td>-87.942406</td>
      <td>7.078433</td>
      <td>119.408408</td>
      <td>121.095409</td>
      <td>[[0.0006532274198047049, 0.0004064266826074971...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>80976 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.2-Portfolio-(Environment)">
<a class="anchor" href="#3.3.2-Portfolio-(Environment)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.2 Portfolio (Environment)<a class="anchor-link" href="#3.3.2-Portfolio-(Environment)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Portfolio</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
    <span class="sd">"""A portfolio/market environment</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        df: DataFrame</span>
<span class="sd">            input data</span>
<span class="sd">        stock_dim : int</span>
<span class="sd">            number of unique stocks</span>
<span class="sd">        hmax : int</span>
<span class="sd">            maximum number of shares to trade</span>
<span class="sd">        initial_amount : int</span>
<span class="sd">            start money</span>
<span class="sd">        transaction_cost_pct: float</span>
<span class="sd">            transaction cost percentage per trade</span>
<span class="sd">        reward_scaling: float</span>
<span class="sd">            scaling factor for reward, good for training</span>
<span class="sd">        state_space: int</span>
<span class="sd">            the dimension of input features</span>
<span class="sd">        action_space: int</span>
<span class="sd">            equals stock dimension</span>
<span class="sd">        tech_indicator_list: list</span>
<span class="sd">            a list of technical indicator names</span>
<span class="sd">        turbulence_threshold: int</span>
<span class="sd">            a threshold to control risk aversion</span>
<span class="sd">        day: int</span>
<span class="sd">            an increment number to control date</span>
<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    _sell_stock()</span>
<span class="sd">        perform sell action based on the sign of the action</span>
<span class="sd">    _buy_stock()</span>
<span class="sd">        perform buy action based on the sign of the action</span>
<span class="sd">    step()</span>
<span class="sd">        at each step the agent will return actions, then </span>
<span class="sd">        we will calculate the reward, and return the next observation.</span>
<span class="sd">    reset()</span>
<span class="sd">        reset the environment</span>
<span class="sd">    render()</span>
<span class="sd">        use render to return other functions</span>
<span class="sd">    save_asset_memory()</span>
<span class="sd">        return account value at each time step</span>
<span class="sd">    save_action_memory()</span>
<span class="sd">        return actions/positions at each time step</span>
<span class="sd">    """</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'render.modes'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'human'</span><span class="p">]}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="n">df</span><span class="p">,</span>
                <span class="n">stock_dim</span><span class="p">,</span>
                <span class="n">hmax</span><span class="p">,</span>
                <span class="n">initial_amount</span><span class="p">,</span>
                <span class="n">transaction_cost_pct</span><span class="p">,</span>
                <span class="n">reward_scaling</span><span class="p">,</span>
                <span class="n">state_space</span><span class="p">,</span>
                <span class="n">action_space</span><span class="p">,</span>
                <span class="n">tech_indicator_list</span><span class="p">,</span>
                <span class="n">turbulence_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">lookback</span><span class="o">=</span><span class="n">LOOKBACK</span><span class="p">,</span>
                <span class="n">day</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1">#super(StockEnv, self).__init__()</span>
        <span class="c1">#money = 10 , scope = 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookback</span> <span class="o">=</span> <span class="n">lookback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span> <span class="o">=</span> <span class="n">stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="n">hmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span> <span class="o">=</span> <span class="n">initial_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_cost_pct</span> <span class="o">=</span> <span class="n">transaction_cost_pct</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reward_scaling</span> <span class="o">=</span> <span class="n">reward_scaling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">=</span> <span class="n">state_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="o">=</span> <span class="n">tech_indicator_list</span>

        <span class="c1"># action_space normalization and shape is self.stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_space</span><span class="p">,))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span><span class="p">))</span>

        <span class="c1"># load data from a pandas dataframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbulence_threshold</span> <span class="o">=</span> <span class="n">turbulence_threshold</span>
        <span class="c1"># initalize state: inital portfolio return + individual stock return + individual weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>

        <span class="c1"># memorize portfolio value each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="c1"># memorize portfolio return each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">daily_return</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/cumulative_reward.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/rewards.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"begin_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>           
            <span class="nb">print</span><span class="p">(</span><span class="s2">"end_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="p">))</span>

            <span class="n">df_daily_return</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df_daily_return</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
              <span class="n">sharpe</span> <span class="o">=</span> <span class="p">(</span><span class="mi">252</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span> \
                       <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">"Sharpe: "</span><span class="p">,</span><span class="n">sharpe</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">softmax_normalization</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">last_day_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

            <span class="c1">#load next state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">portfolio_return</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">log_portfolio_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">))</span>
            <span class="c1"># update portfolio value</span>
            <span class="n">new_portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>

            <span class="c1"># save into memory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_portfolio_value</span><span class="p">)</span>

            <span class="c1"># the reward is the new portfolio value or end portfolo value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reward</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
        <span class="c1"># load states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>
        <span class="c1">#self.cost = 0</span>
        <span class="c1">#self.trades = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'human'</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        
    <span class="k">def</span> <span class="nf">softmax_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
        <span class="n">softmax_output</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
        <span class="k">return</span> <span class="n">softmax_output</span>

    <span class="k">def</span> <span class="nf">save_asset_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">portfolio_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span>
        <span class="c1">#print(len(date_list))</span>
        <span class="c1">#print(len(asset_list))</span>
        <span class="n">df_account_value</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">date_list</span><span class="p">,</span><span class="s1">'daily_return'</span><span class="p">:</span><span class="n">portfolio_return</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">df_account_value</span>

    <span class="k">def</span> <span class="nf">save_action_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># date and close price length must match actions length</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">date_list</span><span class="p">)</span>
        <span class="n">df_date</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">]</span>
        
        <span class="n">action_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span>
        <span class="n">df_actions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">action_list</span><span class="p">)</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">values</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">date</span>
        <span class="c1">#df_actions = pd.DataFrame({'date':date_list,'actions':action_list})</span>
        <span class="k">return</span> <span class="n">df_actions</span>

    <span class="k">def</span> <span class="nf">_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">np_random</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">seeding</span><span class="o">.</span><span class="n">np_random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">seed</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_sb_env</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">DummyVecEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">])</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">obs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"hmax"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
    <span class="s2">"initial_amount"</span><span class="p">:</span> <span class="n">INITIAL_AMOUNT</span><span class="p">,</span> 
    <span class="s2">"transaction_cost_pct"</span><span class="p">:</span> <span class="n">TRANSACTION_COST_PCT</span><span class="p">,</span> 
    <span class="s2">"state_space"</span><span class="p">:</span> <span class="n">state_space</span><span class="p">,</span> 
    <span class="s2">"stock_dim"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"tech_indicator_list"</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">TECHNICAL_INDICATORS_LIST</span><span class="p">,</span> 
    <span class="s2">"action_space"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"reward_scaling"</span><span class="p">:</span> <span class="n">REWARD_SCALING</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1"># e_train_gym = StockPortfolioEnv(df=train, **env_kwargs)</span>
<span class="n">e_train_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_train</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">e_train_gym</span><span class="o">.</span><span class="n">get_sb_env</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">env_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv'&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.3-Portfolio-Manager-(Agent)">
<a class="anchor" href="#3.3.3-Portfolio-Manager-(Agent)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3 Portfolio Manager (Agent)<a class="anchor-link" href="#3.3.3-Portfolio-Manager-(Agent)"> </a>
</h4>
<ul>
<li>
<p>We investigate the performance of two models for the <em>agent</em>:</p>
<ul>
<li>A2C</li>
<li>PPO</li>
</ul>
</li>
</ul>
<p>Both models are based on algorithm implementations in the <em>OpenAI Baselines</em> and <em>Stable Baselines</em> libraries.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.1-A2C">
<a class="anchor" href="#3.3.3.1-A2C" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.1 A2C<a class="anchor-link" href="#3.3.3.1-A2C"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env_train</span><span class="p">)</span>
<span class="n">A2C_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> 
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.0004</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">"a2c"</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="n">A2C_PARAMS</span><span class="p">)</span>
<span class="n">model_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 10, 'ent_coef': 0.005, 'learning_rate': 0.0004}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.a2c.a2c.A2C at 0x7fb1c057a510&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># train A2C agent</span>
<span class="c1"># trained_a2c = agent.train_model(model=model_a2c, tb_log_name='a2c', total_timesteps=40000)</span>
<span class="n">trained_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_a2c</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'a2c'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">20_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/a2c/a2c_1
-------------------------------------
| time/                 |           |
|    fps                | 82        |
|    iterations         | 100       |
|    time_elapsed       | 12        |
|    total_timesteps    | 1000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 99        |
|    policy_loss        | 4.31e+08  |
|    reward             | 2037159.8 |
|    std                | 0.997     |
|    value_loss         | 1.45e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 121       |
|    iterations         | 200       |
|    time_elapsed       | 16        |
|    total_timesteps    | 2000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | 1.79e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 199       |
|    policy_loss        | 7.61e+08  |
|    reward             | 3682380.0 |
|    std                | 0.997     |
|    value_loss         | 4.62e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5543254.538364314
Sharpe:  0.9114471966167719
=================================
-------------------------------------
| time/                 |           |
|    fps                | 141       |
|    iterations         | 300       |
|    time_elapsed       | 21        |
|    total_timesteps    | 3000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 299       |
|    policy_loss        | 2.18e+08  |
|    reward             | 1066029.9 |
|    std                | 0.996     |
|    value_loss         | 3.61e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 155       |
|    iterations         | 400       |
|    time_elapsed       | 25        |
|    total_timesteps    | 4000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 399       |
|    policy_loss        | 4.74e+08  |
|    reward             | 2334651.0 |
|    std                | 0.996     |
|    value_loss         | 1.89e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 166       |
|    iterations         | 500       |
|    time_elapsed       | 30        |
|    total_timesteps    | 5000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 499       |
|    policy_loss        | 8.3e+08   |
|    reward             | 3762730.0 |
|    std                | 0.997     |
|    value_loss         | 5.26e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5441207.40928862
Sharpe:  0.9056919601861874
=================================
-------------------------------------
| time/                 |           |
|    fps                | 172       |
|    iterations         | 600       |
|    time_elapsed       | 34        |
|    total_timesteps    | 6000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | 1.79e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 599       |
|    policy_loss        | 2.61e+08  |
|    reward             | 1273924.4 |
|    std                | 0.995     |
|    value_loss         | 5.48e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 178       |
|    iterations         | 700       |
|    time_elapsed       | 39        |
|    total_timesteps    | 7000      |
| train/                |           |
|    entropy_loss       | -39.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 699       |
|    policy_loss        | 5.06e+08  |
|    reward             | 2385146.2 |
|    std                | 0.995     |
|    value_loss         | 1.97e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 182       |
|    iterations         | 800       |
|    time_elapsed       | 43        |
|    total_timesteps    | 8000      |
| train/                |           |
|    entropy_loss       | -39.5     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 799       |
|    policy_loss        | 9.39e+08  |
|    reward             | 4300851.5 |
|    std                | 0.993     |
|    value_loss         | 6.29e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5419791.789745246
Sharpe:  0.9024995266394125
=================================
-------------------------------------
| time/                 |           |
|    fps                | 185       |
|    iterations         | 900       |
|    time_elapsed       | 48        |
|    total_timesteps    | 9000      |
| train/                |           |
|    entropy_loss       | -39.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 899       |
|    policy_loss        | 3.2e+08   |
|    reward             | 1497831.9 |
|    std                | 0.993     |
|    value_loss         | 7.77e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 189       |
|    iterations         | 1000      |
|    time_elapsed       | 52        |
|    total_timesteps    | 10000     |
| train/                |           |
|    entropy_loss       | -39.5     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 999       |
|    policy_loss        | 5.5e+08   |
|    reward             | 2693180.2 |
|    std                | 0.991     |
|    value_loss         | 2.59e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 191       |
|    iterations         | 1100      |
|    time_elapsed       | 57        |
|    total_timesteps    | 11000     |
| train/                |           |
|    entropy_loss       | -39.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1099      |
|    policy_loss        | 9.87e+08  |
|    reward             | 4592442.5 |
|    std                | 0.991     |
|    value_loss         | 8.27e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5676820.759553938
Sharpe:  0.92196470689131
=================================
-------------------------------------
| time/                 |           |
|    fps                | 193       |
|    iterations         | 1200      |
|    time_elapsed       | 61        |
|    total_timesteps    | 12000     |
| train/                |           |
|    entropy_loss       | -39.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1199      |
|    policy_loss        | 2.79e+08  |
|    reward             | 1435746.4 |
|    std                | 0.991     |
|    value_loss         | 6.6e+13   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 195       |
|    iterations         | 1300      |
|    time_elapsed       | 66        |
|    total_timesteps    | 13000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1299      |
|    policy_loss        | 6.3e+08   |
|    reward             | 2933145.0 |
|    std                | 0.99      |
|    value_loss         | 3.02e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 197       |
|    iterations         | 1400      |
|    time_elapsed       | 70        |
|    total_timesteps    | 14000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 1399      |
|    policy_loss        | 1.1e+09   |
|    reward             | 5293221.5 |
|    std                | 0.99      |
|    value_loss         | 9.53e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5768721.230868419
Sharpe:  0.9343037489353669
=================================
-------------------------------------
| time/                 |           |
|    fps                | 198       |
|    iterations         | 1500      |
|    time_elapsed       | 75        |
|    total_timesteps    | 15000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1499      |
|    policy_loss        | 3.23e+08  |
|    reward             | 1613313.6 |
|    std                | 0.989     |
|    value_loss         | 9.51e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 200       |
|    iterations         | 1600      |
|    time_elapsed       | 79        |
|    total_timesteps    | 16000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 1599      |
|    policy_loss        | 6.38e+08  |
|    reward             | 3004113.2 |
|    std                | 0.988     |
|    value_loss         | 3.09e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 201       |
|    iterations         | 1700      |
|    time_elapsed       | 84        |
|    total_timesteps    | 17000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 1699      |
|    policy_loss        | 1.05e+09  |
|    reward             | 5046972.0 |
|    std                | 0.988     |
|    value_loss         | 8.5e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5450241.863284031
Sharpe:  0.9120601156970355
=================================
-------------------------------------
| time/                 |           |
|    fps                | 202       |
|    iterations         | 1800      |
|    time_elapsed       | 88        |
|    total_timesteps    | 18000     |
| train/                |           |
|    entropy_loss       | -39.4     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1799      |
|    policy_loss        | 3.82e+08  |
|    reward             | 1679890.6 |
|    std                | 0.987     |
|    value_loss         | 1.07e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 203       |
|    iterations         | 1900      |
|    time_elapsed       | 93        |
|    total_timesteps    | 19000     |
| train/                |           |
|    entropy_loss       | -39.3     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1899      |
|    policy_loss        | 7.27e+08  |
|    reward             | 3223228.5 |
|    std                | 0.987     |
|    value_loss         | 3.63e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 204       |
|    iterations         | 2000      |
|    time_elapsed       | 97        |
|    total_timesteps    | 20000     |
| train/                |           |
|    entropy_loss       | -39.3     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 1999      |
|    policy_loss        | 1.22e+09  |
|    reward             | 5834281.0 |
|    std                | 0.986     |
|    value_loss         | 1.16e+15  |
-------------------------------------
CPU times: user 1min 32s, sys: 814 ms, total: 1min 33s
Wall time: 1min 37s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.2-PPO">
<a class="anchor" href="#3.3.3.2-PPO" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.2 PPO<a class="anchor-link" href="#3.3.3.2-PPO"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span> <span class="o">=</span> <span class="n">env_train</span><span class="p">)</span>
<span class="n">PPO_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
  <span class="s2">"batch_size"</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="s2">"ppo"</span><span class="p">,</span><span class="n">model_kwargs</span> <span class="o">=</span> <span class="n">PPO_PARAMS</span><span class="p">)</span>
<span class="n">model_ppo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 2048, 'ent_coef': 0.005, 'learning_rate': 0.001, 'batch_size': 128}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.ppo.ppo.PPO at 0x7fb145e6f390&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># train PPO agent</span>
<span class="c1"># trained_ppo = agent.train_model(model=model_ppo, tb_log_name='ppo', total_timesteps=40000)</span>
<span class="n">trained_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_ppo</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'ppo'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">20_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/ppo/ppo_1
----------------------------------
| time/              |           |
|    fps             | 281       |
|    iterations      | 1         |
|    time_elapsed    | 7         |
|    total_timesteps | 2048      |
| train/             |           |
|    reward          | 4340690.0 |
----------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6072898.409734788
Sharpe:  0.9517677390580576
=================================
-------------------------------------------
| time/                   |               |
|    fps                  | 252           |
|    iterations           | 2             |
|    time_elapsed         | 16            |
|    total_timesteps      | 4096          |
| train/                  |               |
|    approx_kl            | 8.6729415e-09 |
|    clip_fraction        | 0             |
|    clip_range           | 0.2           |
|    entropy_loss         | -39.7         |
|    explained_variance   | 0             |
|    learning_rate        | 0.001         |
|    loss                 | 9.02e+14      |
|    n_updates            | 10            |
|    policy_gradient_loss | -5.42e-06     |
|    reward               | 2559150.8     |
|    std                  | 1             |
|    value_loss           | 1.88e+15      |
-------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6348156.4488777025
Sharpe:  0.9723885522061954
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 243          |
|    iterations           | 3            |
|    time_elapsed         | 25           |
|    total_timesteps      | 6144         |
| train/                  |              |
|    approx_kl            | 8.731149e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 2.23e+15     |
|    n_updates            | 20           |
|    policy_gradient_loss | -3.98e-06    |
|    reward               | 1375805.0    |
|    std                  | 1            |
|    value_loss           | 3.87e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 241          |
|    iterations           | 4            |
|    time_elapsed         | 33           |
|    total_timesteps      | 8192         |
| train/                  |              |
|    approx_kl            | 9.284122e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 2.45e+15     |
|    n_updates            | 30           |
|    policy_gradient_loss | -3.31e-06    |
|    reward               | 5057673.5    |
|    std                  | 1            |
|    value_loss           | 4.99e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5741511.810728012
Sharpe:  0.9276466154007235
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 239          |
|    iterations           | 5            |
|    time_elapsed         | 42           |
|    total_timesteps      | 10240        |
| train/                  |              |
|    approx_kl            | 9.778887e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.001        |
|    loss                 | 1.27e+15     |
|    n_updates            | 40           |
|    policy_gradient_loss | -4.24e-06    |
|    reward               | 3419713.8    |
|    std                  | 1            |
|    value_loss           | 2.64e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5908261.562152228
Sharpe:  0.9364453918533987
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 237          |
|    iterations           | 6            |
|    time_elapsed         | 51           |
|    total_timesteps      | 12288        |
| train/                  |              |
|    approx_kl            | 9.167707e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.65e+15     |
|    n_updates            | 50           |
|    policy_gradient_loss | -5.11e-06    |
|    reward               | 1659724.6    |
|    std                  | 1            |
|    value_loss           | 2.89e+15     |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 237         |
|    iterations           | 7           |
|    time_elapsed         | 60          |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 9.19681e-09 |
|    clip_fraction        | 0           |
|    clip_range           | 0.2         |
|    entropy_loss         | -39.7       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.001       |
|    loss                 | 2.11e+15    |
|    n_updates            | 60          |
|    policy_gradient_loss | -2.77e-06   |
|    reward               | 6544447.0   |
|    std                  | 1           |
|    value_loss           | 4.3e+15     |
-----------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5875338.03680895
Sharpe:  0.9297488171629716
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 236          |
|    iterations           | 8            |
|    time_elapsed         | 69           |
|    total_timesteps      | 16384        |
| train/                  |              |
|    approx_kl            | 9.051291e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 2.38e-07     |
|    learning_rate        | 0.001        |
|    loss                 | 2.01e+15     |
|    n_updates            | 70           |
|    policy_gradient_loss | -3.51e-06    |
|    reward               | 3706120.2    |
|    std                  | 1            |
|    value_loss           | 4.31e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5836648.436389265
Sharpe:  0.9306543489358773
=================================
--------------------------------------------
| time/                   |                |
|    fps                  | 235            |
|    iterations           | 9              |
|    time_elapsed         | 78             |
|    total_timesteps      | 18432          |
| train/                  |                |
|    approx_kl            | 1.00408215e-08 |
|    clip_fraction        | 0              |
|    clip_range           | 0.2            |
|    entropy_loss         | -39.7          |
|    explained_variance   | 0              |
|    learning_rate        | 0.001          |
|    loss                 | 1.07e+15       |
|    n_updates            | 80             |
|    policy_gradient_loss | -4.7e-06       |
|    reward               | 2322794.2      |
|    std                  | 1              |
|    value_loss           | 1.98e+15       |
--------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5903966.678327709
Sharpe:  0.937507280777991
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 234          |
|    iterations           | 10           |
|    time_elapsed         | 87           |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 9.487849e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.93e+15     |
|    n_updates            | 90           |
|    policy_gradient_loss | -3.17e-06    |
|    reward               | 1349593.9    |
|    std                  | 1            |
|    value_loss           | 3.78e+15     |
------------------------------------------
CPU times: user 1min 28s, sys: 929 ms, total: 1min 29s
Wall time: 1min 28s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.4-Evaluation">
<a class="anchor" href="#3.4-Evaluation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 Evaluation<a class="anchor-link" href="#3.4-Evaluation"> </a>
</h3>
<p>We now use the most recent data to evaluate the performance of the two models of the agent. This is also referred to as <em>back-testing</em> or simply <em>trading</em>. This data has never been seen by the training process. The start date of this data is captured in the parameter TRADE_START.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'2020-07-01'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trade</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">,</span> <span class="n">DATA_END</span><span class="p">)</span>
<span class="c1"># e_trade_gym = StockPortfolioEnv(df=trade, **env_kwargs)</span>
<span class="n">e_trade_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">trade</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
<span class="n">e_trade_gym</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.Portfolio at 0x7fb145070e10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baseline_df</span> <span class="o">=</span> <span class="n">get_baseline</span><span class="p">(</span>
        <span class="n">ticker</span><span class="o">=</span><span class="s2">"^DJI"</span><span class="p">,</span> 
        <span class="n">start</span><span class="o">=</span><span class="s1">'2020-07-01'</span><span class="p">,</span>
        <span class="n">end</span><span class="o">=</span><span class="s1">'2021-09-01'</span><span class="p">)</span>

<span class="n">baseline_df_stats</span> <span class="o">=</span> <span class="n">backtest_stats</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">'close'</span><span class="p">)</span>
<span class="n">baseline_returns</span> <span class="o">=</span> <span class="n">get_daily_return</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span><span class="o">=</span><span class="s2">"close"</span><span class="p">)</span>

<span class="n">dji_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">baseline_returns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (295, 8)
Annual return          0.311845
Cumulative returns     0.374034
Annual volatility      0.140762
Sharpe ratio           2.006165
Calmar ratio           3.491806
Stability              0.950106
Max drawdown          -0.089308
Omega ratio            1.397014
Sortino ratio          2.988706
Skew                        NaN
Kurtosis                    NaN
Tail ratio             1.094883
Daily value at risk   -0.016614
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_daily_return_a2c</span><span class="p">,</span> <span class="n">df_actions_a2c</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_a2c</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">df_daily_return_ppo</span><span class="p">,</span> <span class="n">df_actions_ppo</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_ppo</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">time_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<span class="n">a2c_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">ppo_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">DRL_strat_a2c</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="p">)</span>
<span class="n">DRL_strat_ppo</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="p">)</span>

<span class="n">perf_func</span> <span class="o">=</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">perf_stats</span>
<span class="n">perf_stats_all_a2c</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
<span class="n">perf_stats_all_ppo</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=================================
begin_total_asset:1000000
end_total_asset:1399571.9069731692
Sharpe:  2.157741096379009
=================================
hit end!
=================================
begin_total_asset:1000000
end_total_asset:1395976.243353623
Sharpe:  2.0377778142744063
=================================
hit end!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.1-Inspect-actions">
<a class="anchor" href="#3.4.1-Inspect-actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.1 Inspect actions<a class="anchor-link" href="#3.4.1-Inspect-actions"> </a>
</h4>
<p>For the sake of interest, we inspect some the actions taken by the A2C agent.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Inspect the actions taken by the A2C agent (for interest sake)</span>
<span class="c1"># A2C actions</span>
<span class="n">df_actions_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>AMGN</th>
      <th>AXP</th>
      <th>BA</th>
      <th>CAT</th>
      <th>CRM</th>
      <th>CSCO</th>
      <th>CVX</th>
      <th>DIS</th>
      <th>GS</th>
      <th>HD</th>
      <th>HON</th>
      <th>IBM</th>
      <th>INTC</th>
      <th>JNJ</th>
      <th>JPM</th>
      <th>KO</th>
      <th>MCD</th>
      <th>MMM</th>
      <th>MRK</th>
      <th>MSFT</th>
      <th>NKE</th>
      <th>PG</th>
      <th>TRV</th>
      <th>UNH</th>
      <th>VZ</th>
      <th>WBA</th>
      <th>WMT</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-07-01</th>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
    </tr>
    <tr>
      <th>2020-07-02</th>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.038833</td>
      <td>0.031895</td>
      <td>0.039480</td>
      <td>0.036538</td>
      <td>0.065297</td>
      <td>0.024021</td>
      <td>0.028713</td>
      <td>0.024517</td>
      <td>0.065297</td>
      <td>0.065297</td>
      <td>0.048245</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.034142</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.024021</td>
      <td>0.065297</td>
      <td>0.065297</td>
      <td>0.024021</td>
      <td>0.046597</td>
      <td>0.024021</td>
      <td>0.032278</td>
    </tr>
    <tr>
      <th>2020-07-06</th>
      <td>0.023105</td>
      <td>0.062806</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.059748</td>
      <td>0.062806</td>
      <td>0.029078</td>
      <td>0.062806</td>
      <td>0.062806</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.062806</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.023105</td>
      <td>0.062806</td>
      <td>0.041030</td>
      <td>0.037308</td>
      <td>0.062806</td>
      <td>0.023105</td>
      <td>0.023507</td>
    </tr>
    <tr>
      <th>2020-07-07</th>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.063559</td>
      <td>0.063559</td>
      <td>0.063559</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.063559</td>
      <td>0.063559</td>
      <td>0.063559</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.027503</td>
      <td>0.025064</td>
      <td>0.025307</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.023382</td>
      <td>0.063559</td>
      <td>0.035947</td>
      <td>0.039830</td>
      <td>0.050707</td>
      <td>0.023382</td>
      <td>0.023382</td>
    </tr>
    <tr>
      <th>2020-07-08</th>
      <td>0.025965</td>
      <td>0.070581</td>
      <td>0.044694</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.070581</td>
      <td>0.025965</td>
      <td>0.070581</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.028193</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.042503</td>
      <td>0.038366</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.070581</td>
      <td>0.025965</td>
      <td>0.025965</td>
      <td>0.070581</td>
      <td>0.025965</td>
      <td>0.025965</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-08-26</th>
      <td>0.022128</td>
      <td>0.060151</td>
      <td>0.022128</td>
      <td>0.060151</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.028515</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.060151</td>
      <td>0.022128</td>
      <td>0.060151</td>
      <td>0.060151</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.053942</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.022128</td>
      <td>0.060151</td>
      <td>0.060151</td>
      <td>0.060151</td>
      <td>0.060151</td>
      <td>0.022128</td>
      <td>0.022128</td>
    </tr>
    <tr>
      <th>2021-08-27</th>
      <td>0.024457</td>
      <td>0.059850</td>
      <td>0.024457</td>
      <td>0.057124</td>
      <td>0.066480</td>
      <td>0.024457</td>
      <td>0.037117</td>
      <td>0.024457</td>
      <td>0.042555</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.054486</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.066480</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.032891</td>
      <td>0.024457</td>
      <td>0.024457</td>
      <td>0.059408</td>
      <td>0.024457</td>
      <td>0.066480</td>
      <td>0.024457</td>
      <td>0.041368</td>
    </tr>
    <tr>
      <th>2021-08-30</th>
      <td>0.024208</td>
      <td>0.065804</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.061345</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.059168</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.065804</td>
      <td>0.065804</td>
      <td>0.024272</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.063400</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.024208</td>
      <td>0.065452</td>
      <td>0.024208</td>
      <td>0.065804</td>
      <td>0.027401</td>
    </tr>
    <tr>
      <th>2021-08-31</th>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.026724</td>
      <td>0.047380</td>
      <td>0.025266</td>
      <td>0.068680</td>
      <td>0.053696</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.068680</td>
      <td>0.031668</td>
      <td>0.028940</td>
      <td>0.051544</td>
      <td>0.025266</td>
      <td>0.043039</td>
      <td>0.032060</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.025266</td>
      <td>0.048233</td>
      <td>0.068680</td>
      <td>0.029846</td>
      <td>0.032170</td>
      <td>0.040205</td>
      <td>0.025266</td>
    </tr>
    <tr>
      <th>2021-09-01</th>
      <td>0.047668</td>
      <td>0.026291</td>
      <td>0.020787</td>
      <td>0.026123</td>
      <td>0.020787</td>
      <td>0.020787</td>
      <td>0.056504</td>
      <td>0.056504</td>
      <td>0.020787</td>
      <td>0.020787</td>
      <td>0.020787</td>
      <td>0.056504</td>
      <td>0.020787</td>
      <td>0.020787</td>
      <td>0.056504</td>
      <td>0.036987</td>
      <td>0.056504</td>
      <td>0.024576</td>
      <td>0.038069</td>
      <td>0.020787</td>
      <td>0.032040</td>
      <td>0.027716</td>
      <td>0.056504</td>
      <td>0.056504</td>
      <td>0.030170</td>
      <td>0.056504</td>
      <td>0.050459</td>
      <td>0.020787</td>
    </tr>
  </tbody>
</table>
<p>296 rows × 28 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the A2C agent's actions specifically on AAPL:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_actions_a2c</span><span class="p">[</span><span class="s1">'AAPL'</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'AAPL A2C'</span><span class="p">))</span>
<span class="c1"># fig.add_trace(go.Scatter(x=time_ind, y=-df_actions_ppo['AAPL'], mode='lines', name='AAPL PPO'))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"AAPL actions of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Actions"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="fcc57a69-2fe2-41ef-bcf5-999842b65519" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("fcc57a69-2fe2-41ef-bcf5-999842b65519")) {
                    Plotly.newPlot(
                        'fcc57a69-2fe2-41ef-bcf5-999842b65519',
                        [{"line": {"width": 2}, "mode": "lines", "name": "AAPL A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [0.03571428571428571, 0.02402137778699398, 0.023105204105377197, 0.023382015526294708, 0.02596525475382805, 0.022626686841249466, 0.02469547465443611, 0.031908001750707626, 0.02357112057507038, 0.02412593737244606, 0.02271173521876335, 0.02570270001888275, 0.0237874835729599, 0.022356029599905014, 0.02550096996128559, 0.024100255221128464, 0.06024983525276184, 0.025129660964012146, 0.024240316823124886, 0.0238434337079525, 0.028074491769075394, 0.02546670101583004, 0.021134862676262856, 0.022826487198472023, 0.020942354574799538, 0.025509405881166458, 0.022514015436172485, 0.024069055914878845, 0.051031049340963364, 0.02726818434894085, 0.024985631927847862, 0.021597621962428093, 0.024181626737117767, 0.023696403950452805, 0.025489574298262596, 0.026221809908747673, 0.03061380796134472, 0.025278832763433456, 0.02922664023935795, 0.027688048779964447, 0.027394291013479233, 0.023656051605939865, 0.024340780451893806, 0.023100342601537704, 0.02236992120742798, 0.02819906175136566, 0.023282065987586975, 0.023892398923635483, 0.025797713547945023, 0.03532266244292259, 0.024380704388022423, 0.025658855214715004, 0.023454289883375168, 0.029865164309740067, 0.02578238770365715, 0.022454671561717987, 0.024977145716547966, 0.02077299915254116, 0.02621423453092575, 0.022261952981352806, 0.02374846674501896, 0.021715855225920677, 0.026339858770370483, 0.0235911775380373, 0.023301230743527412, 0.023882418870925903, 0.0221110787242651, 0.02427629753947258, 0.02396438829600811, 0.0231478251516819, 0.024599861353635788, 0.024282775819301605, 0.022740161046385765, 0.021433478221297264, 0.02329299971461296, 0.023960618302226067, 0.025533782318234444, 0.031812265515327454, 0.02187192440032959, 0.022503023967146873, 0.02419346198439598, 0.025408882647752762, 0.02746979519724846, 0.024568667635321617, 0.02717188559472561, 0.03416623920202255, 0.023180365562438965, 0.022326409816741943, 0.02390226535499096, 0.024045195430517197, 0.02445892058312893, 0.02220391109585762, 0.02601075917482376, 0.033749014139175415, 0.022227268666028976, 0.02710837498307228, 0.02459232322871685, 0.03085904009640217, 0.022232582792639732, 0.02424241043627262, 0.023177841678261757, 0.05518180504441261, 0.032737113535404205, 0.02394915744662285, 0.028972167521715164, 0.02693628892302513, 0.024584732949733734, 0.02204732969403267, 0.02738562785089016, 0.028076594695448875, 0.026373781263828278, 0.02218872308731079, 0.028933590278029442, 0.020797260105609894, 0.02381221018731594, 0.024297738447785378, 0.027390193194150925, 0.024374552071094513, 0.02161145582795143, 0.02049349434673786, 0.02456468902528286, 0.020255805924534798, 0.029047373682260513, 0.022283874452114105, 0.020767223089933395, 0.027039047330617905, 0.02451975829899311, 0.022791292518377304, 0.024576347321271896, 0.025691553950309753, 0.025827817618846893, 0.022124096751213074, 0.023972129449248314, 0.025718776509165764, 0.022780805826187134, 0.022674955427646637, 0.023709382861852646, 0.02483045682311058, 0.02503499574959278, 0.023458141833543777, 0.027139313519001007, 0.022629396989941597, 0.026102153584361076, 0.02706897258758545, 0.027129322290420532, 0.023976687341928482, 0.021343177184462547, 0.025212714448571205, 0.024018367752432823, 0.0256673414260149, 0.025733651593327522, 0.02280779741704464, 0.028537141159176826, 0.022119902074337006, 0.024359872564673424, 0.025418240576982498, 0.026670388877391815, 0.023979652673006058, 0.022122157737612724, 0.02320524863898754, 0.023042526096105576, 0.026729455217719078, 0.02439996227622032, 0.021723659709095955, 0.02460285648703575, 0.020779214799404144, 0.02601681835949421, 0.022707002237439156, 0.025383150205016136, 0.02457159198820591, 0.02383379079401493, 0.021041905507445335, 0.026577286422252655, 0.0245651975274086, 0.02579435706138611, 0.021475210785865784, 0.022250628098845482, 0.023647470399737358, 0.02225997857749462, 0.02300131879746914, 0.023631783202290535, 0.02699194848537445, 0.024112192913889885, 0.023395923897624016, 0.024669678881764412, 0.022730596363544464, 0.02789236605167389, 0.0262153223156929, 0.0216413252055645, 0.02468869276344776, 0.025973808020353317, 0.026863599196076393, 0.06371564418077469, 0.023653635755181313, 0.02480287104845047, 0.02227313630282879, 0.023124223574995995, 0.026166358962655067, 0.024563372135162354, 0.023629380390048027, 0.026145348325371742, 0.02462105266749859, 0.025167129933834076, 0.05235454812645912, 0.024887053295969963, 0.02704666182398796, 0.024165194481611252, 0.024029867723584175, 0.02518836408853531, 0.025922486558556557, 0.038116637617349625, 0.024894796311855316, 0.024288589134812355, 0.02183670364320278, 0.02588745951652527, 0.02463465742766857, 0.02248687483370304, 0.025205116719007492, 0.06586899608373642, 0.024052079766988754, 0.02262026071548462, 0.025978166610002518, 0.021038204431533813, 0.025276662781834602, 0.027579087764024734, 0.0261892918497324, 0.027867570519447327, 0.02842582017183304, 0.028897583484649658, 0.022683773189783096, 0.025069087743759155, 0.02616477757692337, 0.024073526263237, 0.022915804758667946, 0.0548955574631691, 0.0223392341285944, 0.040636707097291946, 0.0514494962990284, 0.024411017075181007, 0.02252786234021187, 0.023843923583626747, 0.02423398569226265, 0.02604466676712036, 0.022461488842964172, 0.030042851343750954, 0.02375214546918869, 0.02253822796046734, 0.024033160880208015, 0.023013483732938766, 0.025291264057159424, 0.02507263794541359, 0.026095762848854065, 0.024010909721255302, 0.02659555897116661, 0.02638539858162403, 0.026116691529750824, 0.027987629175186157, 0.02656969614326954, 0.02553289383649826, 0.023937437683343887, 0.02407829836010933, 0.02457435615360737, 0.019603878259658813, 0.027347354218363762, 0.02310643158853054, 0.027611954137682915, 0.02495979331433773, 0.025948811322450638, 0.023478252813220024, 0.022859562188386917, 0.02088470384478569, 0.02222464606165886, 0.023506436496973038, 0.025188839063048363, 0.026686521247029305, 0.024781379848718643, 0.02247297577559948, 0.026297399774193764, 0.022769346833229065, 0.02564483880996704, 0.026351988315582275, 0.022921990603208542, 0.02697005867958069, 0.02464844286441803, 0.024554137140512466, 0.024282332509756088, 0.053091686218976974, 0.02435833029448986, 0.030239084735512733, 0.02174750529229641, 0.02197980135679245, 0.02212836593389511, 0.02445651777088642, 0.02420804835855961, 0.02526581846177578, 0.04766806587576866]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "AAPL actions of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Actions"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('fcc57a69-2fe2-41ef-bcf5-999842b65519');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.2-Inspect-daily-return">
<a class="anchor" href="#3.4.2-Inspect-daily-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.2 Inspect daily return<a class="anchor-link" href="#3.4.2-Inspect-daily-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the daily return of the portfolio:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="c1"># fig.add_trace(go.Scatter(x=time_ind, y=df_actions_a2c['AAPL'], mode='lines', name='AAPL'))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Daily Return of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="11102ebe-6a1e-4a1d-aed1-f648066027cb" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("11102ebe-6a1e-4a1d-aed1-f648066027cb")) {
                    Plotly.newPlot(
                        '11102ebe-6a1e-4a1d-aed1-f648066027cb',
                        [{"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [0.0, 0.004721796625167216, 0.01386051497840689, -0.013854821859376459, 0.005370561728709852, -0.017499329623191888, 0.015031647224100317, -0.003104498633721613, 0.019229962440850578, 0.008311856577497374, -0.0019216279080770846, 0.0013936046879600528, -0.0018005786491020227, 0.006182942815400797, 0.0047692359559851644, -0.007723737156994835, -0.010066665154856234, 0.00408793244225023, -0.003995016739866467, 0.00453364001165838, -0.007613224073463804, -0.003061317879351307, 0.007149584539189802, 0.004338179014300298, 0.013012920264881196, 0.004460451423930995, 0.004484198889045659, 0.011712742738743806, -0.003955458970688463, 0.009431148895665622, -0.0052666965534881125, 0.001544804628282047, -0.004593644156527764, -0.0008543970690465239, -0.0052112747555761426, 0.00037528528723986573, 0.0022913742349919713, 0.012427385307362347, 0.0022098936778058536, 0.008880995407613982, 0.007237753036489318, 0.006478545455604133, -0.007010299008190265, 0.002773603438977829, 0.019113870440402272, -0.02614221777030737, -0.0035198563998996174, -0.020488489789619115, 0.012222178480183282, -0.014521836516007098, 0.006015557215006738, 0.01066142714779223, -0.0023695245357527824, 0.0026317396160521643, -0.004588136432777101, -0.007743850037596233, -0.016372741863272824, 0.0035654862045132046, -0.01814967956501878, 0.0005524351862059556, 0.010900402816894236, 0.015355173900512395, -0.006123243757315646, 0.011837724285557957, -0.0019202521605287733, -0.004687565809794892, 0.014028270196215487, -0.012110175707896076, 0.018223426722599592, 0.010877074520664285, 0.0034579053493803582, 0.009255089236952677, -0.00957326474504186, -0.005187193062135349, 0.0036355629709461214, 0.0032763622804600832, -0.014506842351992158, 0.00464199001076989, -0.0018175674001727697, 0.009242516046342611, -0.008676101474801119, -0.022046035618169705, -0.011059974474866847, -0.031198396601402018, 0.005100904937322319, -0.0028949401354733113, 0.018193109822874268, 0.019561535200154533, 0.006156985590850321, 0.019310219924530997, -0.0022727398782278452, 0.03252847346785997, 0.0115247776605872, -0.00013260792664988006, -0.01129516157177036, 0.01975118274622808, 0.017359910614361863, -0.007496535522132392, -0.012676514267516318, 0.0033941538087890874, -0.005819560622312379, 0.010099063176490439, 0.01801753868314057, -0.004700999729507793, -0.00030628767423448425, -0.00828541708444434, 0.008391615374090885, 0.010313082593152398, 0.0043312281852090455, 0.009376160333008796, -0.007602185664138505, 0.0032994439090473014, -0.0037748925171677146, -0.0007654057409391699, 0.0007344559868421222, -0.006492260180066876, 0.011164280412801693, -0.002285088913693684, 0.003228404893557198, -0.0031122538300766196, -0.000706812922152804, -0.007726809288176713, 0.00406840986388145, 0.0020997745536150796, 0.004940273058385995, -0.0017125777079040443, 0.0005094835347229772, 0.0070402545959278836, -0.009549085590799467, 0.005906435945774372, 0.017149708637885477, 0.0054960168944316054, -0.00041328179473724356, -0.0025667766717851607, 0.005013408486762409, 0.0005678235680595369, 0.0021570070650950837, -0.004966093547062022, 0.0024571503935556056, 0.006654181940876175, -0.0013150095614139308, -0.007462543144253362, -5.515795735870159e-05, -0.0022074230024380463, -0.014531661356582194, 0.007117787356745627, -0.017688002879626307, 0.00615259877132637, 0.012691035287166474, 0.0024279923400306047, 0.010979334214481449, 0.004253194996027953, 0.008393291343805334, -7.904323306190531e-05, 0.0004215892655623911, -0.0002840872748093013, 0.0013729842147128994, 0.0009410844922373638, 0.004354115937758741, -0.003859689301758073, -0.000492417306622846, 0.0017822199746309623, 0.0011967081770376713, 0.012488746911792635, -0.0167249524380549, -0.015826764516314103, 0.016127494779302847, -0.004572638062653746, -0.0031791314315753457, -0.010336147017863123, 0.021522189217803557, 0.00903504576215888, 0.0020615483462250823, 0.016584689368709958, 0.004520939850129151, 0.008795367258710354, 0.0069197464358878285, -0.0019981784868188376, 0.005548515610852506, -0.008161105293794768, -0.0048376701536144906, 0.005466400693530381, -0.009023404733339036, -0.000640129383406873, 0.005744742904725013, 0.014963565605174223, 0.00399017298318203, -0.003868293604614324, -0.0032936302100027466, 0.002724281904160829, 0.013818161862314942, -0.0025627459464935484, 0.0014029031204631955, 3.00012629413222e-05, 0.006829185078288835, -0.0025558913380073363, -0.0013749292497176329, -0.00027956931974875473, 0.005762383569901823, 0.004638457537322803, -0.002797442792388215, -0.005935485337783821, 0.009186507554349752, -0.009532872261121792, 0.004283768069880978, -0.004534633053122474, -0.0004574837339207941, -0.004511672658720644, 0.006507264666577765, -0.003088651214827514, 0.008598372398458181, -0.000784204319449551, 0.0046583057899764095, 0.00831766704732385, 0.005599364569658971, -0.0006233588084643224, -0.015135672323617197, -0.015961890663276534, 0.012312426070130049, 0.00847714872821753, 5.451559268115513e-05, -0.00887569736555111, -0.003698891998505537, 0.006221519818792723, 0.001954806644363022, 0.007022471477468893, -0.003349358146697408, -0.0005612764973962557, 0.003955711804084267, 0.0009912228389604336, 0.001388801788258982, 0.0022174778124074285, 0.00034293124817628105, 0.005657119162879896, -0.0035361719671251233, -0.0010769803293148006, -0.004497304363017737, 0.002783861914669814, 0.00033194617763273687, -0.001458481066547412, -0.0007643198544551024, -0.00775881666344707, -0.006732576076267049, -0.016790508198613985, 0.017023271053064917, 0.0015624183907043954, -0.002649651754269345, 0.008655616662059013, 0.010193391259661313, -0.004220889702148041, -0.0021796727405486416, 0.006418758660051737, 0.0030955642852345836, 0.004007498018196658, -0.007667962310588389, 0.0033745848871243496, -0.004718026909251454, 0.012009345513559144, 0.0029490079267278694, -0.003206680848685503, 9.911875016748557e-05, 0.00011290860666058598, -0.008176889188140985, -0.015938382387863652, 0.013102275024133093, 0.009187858054322186, 0.0008036517955741601, 0.004125700646999196, 0.0041537845986765135, -0.0031699962517537086, -0.0032634703070471933, 0.003534876138057203, -0.0030666029833085647, -0.001868631730738377, 0.00864872936980017, -0.01075758551436114, 0.008842661435844792, 0.00423512492286067, -0.0017752642064723532, 0.006321594408327246, 0.006652729394123982, 0.0004547454152677789, 0.0011056400244210238, 0.0028240499947776374, -0.004799499324327375, -0.01211390098743391, 0.0007859945537300902, 0.006070636060645663, 0.007591814810300468, 0.000557186090923482, 0.0017341434447995612, -0.006136647545784265, 0.00668199183600476, 0.0005841365945487212, 0.0009533901401584048, -0.0014439749288278473]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [0.0, 0.0056836152955955545, 0.016704928823450337, -0.01510108287009761, 0.005527798334391597, -0.01682565996770341, 0.017913691936554864, -0.0011046083426417075, 0.01908911048807265, 0.007979065868372966, -0.001661054856443419, 0.00011599108826365402, 0.0010649137422493774, 0.0060279392180201605, 0.004843302405908402, -0.010446465587116484, -0.014457260463549065, 0.00316546129831974, -0.005148251073372292, 0.003872846371563978, -0.010551111395222327, -0.001325480540643797, 0.00878735655209247, 0.0026310765833991397, 0.010951611281779771, 0.004332738707323851, 0.005450362953404294, 0.013923948254426534, -0.004223483478337395, 0.008057932215135538, -0.005729916675756466, 0.001821991243362452, -0.0014514784794410415, -0.0008408328254388372, -0.0042425940791970115, 0.00035807989764422856, 0.0029819700516751906, 0.012625854709500365, 0.0030464584111958414, 0.006473027570787293, 0.007985071811881406, 0.00525301813010685, -0.0056623121304914545, 0.0058117096543421985, 0.017294037837885197, -0.027418898501174457, -0.0020381486098805914, -0.024961896502643112, 0.011953024813766843, -0.014782996271366597, 0.0048467603453509825, 0.011310670794458416, -0.0014396685069029526, 0.002906920869691332, -0.0033460365683027527, -0.009672502835753393, -0.020180575169446855, 0.00612123765302773, -0.01900196263921345, 0.0015478009146856265, 0.012110367198998662, 0.014584252454489617, -0.0065956374297009715, 0.010086549272781088, -0.0006621324695821147, -0.0030759590727607563, 0.015773511982265905, -0.011678971343811871, 0.018444501192814572, 0.008390857406864778, 0.004239718059815064, 0.01030854138137064, -0.008451502361159513, -0.004093239389006276, 0.0013796197523288413, 0.0022249603193962068, -0.014179906235676009, 0.0025014726031697496, -0.0036286445963298764, 0.009019211063057569, -0.0046843824736080356, -0.021794132475428954, -0.010280116129790172, -0.03248253102236324, 0.00630081771009429, -0.0027209496552349495, 0.015211686371856837, 0.019199182899285315, 0.007910067863680672, 0.020095173512072063, -0.002336040337366301, 0.05019193430953648, 0.011334410388182595, 0.0006776948285314747, -0.011484292880635278, 0.017983524488215493, 0.017650678480859786, -0.012635276612515199, -0.012105975904384203, 0.0037973504339026817, -0.00674467532703927, 0.015008560628210035, 0.016773628291929403, -0.0037505048828583177, 0.00010808357179361132, -0.009333692673023704, 0.008104570438413485, 0.005891347055831992, 0.003952275934624156, 0.01012686322382417, -0.0076076275405752, 0.003707912736344476, -0.004430076875531225, 0.00030153455499363455, 0.0005999624722063391, -0.007943115528487314, 0.011733905907509036, -0.003276418423224944, 0.004091024297583817, -0.004490223413376788, -0.001145816057901796, -0.00681118557718013, 0.0037742734490637734, 0.002242651178290643, 0.006107600838372908, -0.002219106297140429, 0.0017334265544921206, 0.007966368365295823, -0.01331233191009873, 0.00469365179140901, 0.014245501361931085, 0.008950159189460011, 0.001229989523142718, -0.0011857258307022883, 0.0036508987621647407, 0.0018462757893271437, 0.002330345274818084, -0.00829498946250335, 0.0015432249997544053, 0.006981795373316772, -0.0014367579645851833, -0.009281821818768717, -0.0016659639935923231, 0.0006814512527375009, -0.01775517978589318, 0.012764430797408927, -0.01903444072043222, 0.0066972301410869435, 0.014145407654337874, 0.0023393263026080086, 0.011076567502060604, 0.004198577458616532, 0.01068280378488162, -0.0015930477342652016, 0.0016823272810633889, 0.0006223807835578978, 0.0021562932427693004, 0.002723440318520148, 0.0041640568721758265, -0.004304665823657448, 0.0021615748674536596, 0.002512711461689918, 0.0007060295690593879, 0.009359831889489313, -0.01727527030686085, -0.014889634254776378, 0.0175777220238455, -0.006103770630264277, -0.0023529550030825185, -0.010470589774656707, 0.018764887994021373, 0.010147512591307195, 0.0026383133544540813, 0.014006969835218146, 0.0043876392547767835, 0.006165418483478282, 0.009861758966460547, -0.0031107193582112064, 0.00516145954801706, -0.006249127520299634, -0.004105281176547945, 0.0053700556172346535, -0.008759425982700152, 0.0009511639958446457, 0.005184295750424792, 0.013511454223483878, 0.0037500442070462926, -0.004125470831568234, -0.0008403193205561695, 0.00419875440816276, 0.012815692017652053, -0.0028999061819653576, 0.002048613229647788, -0.00010862014887622233, 0.0074225121685488615, -0.003304735059928792, -0.002393127584861459, -0.0009451742703040372, 0.00449701842823342, 0.005556336840001455, -0.002984982967104395, -0.004411275453518179, 0.008661973050061332, -0.010314291172356702, 0.0016483223939613872, -0.0015364210995218327, -0.0009117350815249305, -0.0037671890992752293, 0.005898015521358673, -0.00471200865487148, 0.0061257324986596995, -0.00039913669501909937, 0.003064458166099515, 0.010107604138799813, 0.007595986005258882, 0.000828746393681115, -0.012608559440995678, -0.0187937396963636, 0.01323594401529, 0.009804553431476225, -0.0009084608496278605, -0.006496554356165517, -0.0034060073244229104, 0.005508787017180825, 0.0018951363251742586, 0.007519398106765853, -0.003101634501756276, -0.0011492844435535092, 0.001243670740950291, 0.0004993386353233443, -0.000580086163667043, 0.0034926117468996078, -0.0011633172101661797, 0.006488406705486553, -0.002913218706577525, -0.0016694993578950507, -0.004309215813453485, 0.004690098124830901, 0.0009091345479585263, -0.00334648229822693, -0.0028977281465563977, -0.00650202325804545, -0.006093746214632969, -0.01756032153960134, 0.016658966992120876, 0.0012779489002956576, -0.0016900694287452925, 0.009283377838327712, 0.007617561350681412, -0.004780967009703357, -0.000514175944630055, 0.005386489844472474, 0.003096558388907125, 0.003890390497363794, -0.006324057589183793, 0.0032645456494591737, -0.006366596057213572, 0.013193103378558618, 0.0046999030281076005, -0.0025295690425822795, 0.0018186056226948634, -0.0002768680910953691, -0.006168885235530993, -0.01899720176251504, 0.013752828301457635, 0.007579014634358065, 0.0012876963185002096, 0.004051271147437103, 0.004004232499990041, -0.0034366489362595686, -0.0036528640252322508, 0.0038218737457221697, -0.0048638519115621615, -0.0014847924886780771, 0.008037646799466235, -0.009488857128265988, 0.007042762231252031, 0.0024799730315592725, -0.002122106827976187, 0.004480224220208684, 0.00609757563242206, 0.0010704792734763883, 0.00096962347168517, 0.002384963842251366, -0.008228253718161483, -0.010664176315534896, -0.002149969150254564, 0.006589997881687953, 0.008040628727131337, 0.0008659632213014336, 0.0015153761335114512, -0.004851372157454202, 0.006002313979855239, -0.001204615829876833, 1.7287350225950318e-05, -0.0013775570770976659]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Daily Return of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('11102ebe-6a1e-4a1d-aed1-f648066027cb');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.3-Inspect-cumulative-return">
<a class="anchor" href="#3.4.3-Inspect-cumulative-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.3 Inspect cumulative return<a class="anchor-link" href="#3.4.3-Inspect-cumulative-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we inspect the cumulative return of the portfolio brought about by each of the agents. The DJIA index is used as a baseline for reference. Both agents end up with a larger cumulative return than the DJIA.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dji_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DJIA'</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#d3d3d3"</span><span class="p">)))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">a2c_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ppo_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Cumulative Return of A2C &amp; PPO against DJIA"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Cumulative Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="b78e4db3-d900-4251-a255-017215c9e7cc" class="plotly-graph-div" style="height:900px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("b78e4db3-d900-4251-a255-017215c9e7cc")) {
                    Plotly.newPlot(
                        'b78e4db3-d900-4251-a255-017215c9e7cc',
                        [{"line": {"color": "#d3d3d3", "width": 2}, "mode": "lines", "name": "DJIA", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [null, 0.0035900049368924325, 0.021451689225469472, 0.006031053470604952, 0.01291272477375105, -0.0011222417817438046, 0.013224420655107982, 0.013632425782493796, 0.035267929817957455, 0.044108420380372326, 0.03884753730275681, 0.03640876558337114, 0.036755372617740756, 0.04295437909186228, 0.049382964343949176, 0.03564641225290388, 0.028557247270763586, 0.03302116944014255, 0.025036305701787942, 0.031264834868348634, 0.022486121868004583, 0.02694192339961754, 0.03611543600425149, 0.04249081969489921, 0.05698661347016465, 0.06419318617776382, 0.06600006602761543, 0.07990950421988563, 0.07584774335445332, 0.08711372421934693, 0.08400048420251371, 0.08533325541568781, 0.08198724908083133, 0.07939001108429133, 0.07607975073436779, 0.07790021557637017, 0.08530646490044091, 0.0999997343716621, 0.09766744166896602, 0.10091129493435425, 0.10714210091524179, 0.11342147893510401, 0.10472442767528567, 0.11310249724790111, 0.13077649614212827, 0.0993884856186924, 0.09319380509179198, 0.06861946501693783, 0.08570050556662157, 0.0699285573611117, 0.07502125975377805, 0.08775449566475624, 0.08784268427301933, 0.08927191651984412, 0.08420486623526124, 0.07470182270370973, 0.05489528361706886, 0.06035402185969452, 0.039951868145128966, 0.04198445618859026, 0.055915751798398805, 0.07185125116639313, 0.06674534325063086, 0.0795310217849392, 0.08089885593874802, 0.0756884422453794, 0.09378949561352767, 0.07918365581246056, 0.09980544621576404, 0.10454797456494846, 0.11081923194704446, 0.1205576980800005, 0.1144295005314464, 0.10798649545528893, 0.1072170840004083, 0.11157346463974527, 0.09560722827833734, 0.10001248453189238, 0.0962056509772653, 0.10214464525525124, 0.10105314046692104, 0.07578831850052015, 0.06715448678517966, 0.030502405644070807, 0.03590983967052974, 0.029789383290687255, 0.04624369274997808, 0.0678088432227395, 0.08209410756657487, 0.10317513141962009, 0.10058024613121797, 0.13300967152779153, 0.14322725528894464, 0.1423222974878009, 0.12998651746449386, 0.1455156054751312, 0.16380312993665513, 0.15731041441435978, 0.14390726383458796, 0.14564849553801307, 0.13710953108629464, 0.14984663758162853, 0.16752572136118582, 0.1607734490056203, 0.16224609251227862, 0.15168736607114064, 0.158886880654326, 0.16121325363977235, 0.16454453657531465, 0.1742099928621872, 0.16844077303917926, 0.17248553369097053, 0.16840275023991946, 0.16570017163385353, 0.16753073035270516, 0.16034912670889145, 0.1734736711088578, 0.17173395728165053, 0.17751714156586385, 0.17268642460841632, 0.17413963929948495, 0.16633160814052195, 0.17077382467998437, 0.17349537673877458, 0.18142627997758098, 0.1787722734104895, 0.18164348806437003, 0.18929532976050556, 0.17442879471900485, 0.18094556857935506, 0.197957469867311, 0.20618481433148372, 0.2083934760162276, 0.2049242181324733, 0.2072556760032498, 0.20693631484699226, 0.20425703564087194, 0.1973691410452323, 0.20188672013891606, 0.21190660052268084, 0.21142588912445515, 0.2044692347361421, 0.2030322613206057, 0.20214005367969268, 0.17750940039715246, 0.18917405145069144, 0.16505355636500552, 0.17396326208295898, 0.19244279788605412, 0.19384630213098464, 0.20675712955946324, 0.21034683092111206, 0.21957627726437767, 0.21919043312977404, 0.2215984678557461, 0.22132251795932234, 0.22239891987928395, 0.2248993932669292, 0.22840705341899747, 0.22375658426243206, 0.22379468295550264, 0.22485818292761173, 0.22546669950338916, 0.24196214340818667, 0.2202077137710463, 0.20195859157783658, 0.2253952075335237, 0.2198000881127149, 0.2150816181015851, 0.20163885095252465, 0.22387163927975307, 0.23576746288128625, 0.2369448794635527, 0.2549856731458482, 0.2623130688003963, 0.27370032797510424, 0.2804934312009326, 0.2755386278626675, 0.2828991132187668, 0.27695116347109483, 0.26784565172102526, 0.27185686730839964, 0.2598868195598085, 0.2597667555509684, 0.26751574132505307, 0.2851337305868378, 0.2889609036827854, 0.2849037723398178, 0.2815849359892628, 0.288255243029059, 0.30278723815212283, 0.2990198693791626, 0.299642502203767, 0.30186937840312633, 0.3134113091644435, 0.31126624649323187, 0.30861891858149937, 0.310702507265884, 0.32255787946620873, 0.32895709381347826, 0.32417593551454704, 0.314215631772337, 0.3264949468003362, 0.31400570949139395, 0.3228493117000557, 0.3204433261069779, 0.3205738634617219, 0.3141798098935933, 0.32350488243858977, 0.31629648827952916, 0.3255593278995894, 0.32632873935447004, 0.33010992080101365, 0.3424740851095964, 0.351381438119412, 0.3500236978424527, 0.3316183861864157, 0.3051369105375141, 0.3219929259378862, 0.33600808420873673, 0.3338965666019418, 0.32351657008546764, 0.31711978434014676, 0.324429269055323, 0.3292356240994725, 0.3364686078532637, 0.3333009519740169, 0.333712448216704, 0.33921429414391957, 0.3417326025771259, 0.34351458925700307, 0.3444887622136854, 0.3435818311734584, 0.3505510080405694, 0.345649026794689, 0.34446705658376864, 0.33853428559827603, 0.33927637528123333, 0.33979564073539503, 0.336459652383577, 0.3327906419895401, 0.32246786940648287, 0.3142991149643233, 0.2935735777215227, 0.3163787571705412, 0.3190447549597544, 0.31627265762290624, 0.32880743121838685, 0.3380174487460623, 0.33216664307633925, 0.3325171206950648, 0.34068587513722437, 0.3457769837598619, 0.351715219099739, 0.3435947331213103, 0.3476521680395215, 0.3375546482872085, 0.35497182252535775, 0.359868642992097, 0.3556956976936996, 0.3574225854668651, 0.3595127010189869, 0.3478877424285476, 0.3196843879979996, 0.34105411190769974, 0.35216784978793236, 0.3531529514533842, 0.3624088088428421, 0.365624581398198, 0.3622910216483288, 0.3573331825576278, 0.36330177542186415, 0.3575095597741542, 0.3537283783276106, 0.3645400588404708, 0.351960811471804, 0.36251369408950285, 0.3681193627500263, 0.36397480173690466, 0.3703016133885779, 0.3788618281073477, 0.37944013894638795, 0.38004349474302446, 0.3843185931108901, 0.3733561874895872, 0.3584896524480867, 0.3559028877974506, 0.3646830427802019, 0.37306202307854797, 0.3742491540686095, 0.37577386072954355, 0.368298472143745, 0.377728429935402, 0.375553920465562, 0.37403422279614706]}, {"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [0.0, 0.004721796625167141, 0.018647758136421944, 0.004534574909988542, 0.009929489853165885, -0.007743599185956684, 0.007171648986935564, 0.0040448859787325375, 0.023352631425031634, 0.031858591725641094, 0.02987574345859212, 0.03131098312269254, 0.029454026585897353, 0.03581908196336192, 0.04075914757295718, 0.03272059747336575, 0.022324545020078412, 0.02650373869417466, 0.02240283907455587, 0.027038045493817497, 0.019218974721500803, 0.016098821451211887, 0.023363505875348523, 0.027803039960537568, 0.04117775896754661, 0.04582188178509883, 0.05051155510553906, 0.06281592669456781, 0.05861200190313309, 0.06859592931582004, 0.06296795881782091, 0.06461003664031817, 0.05971959696652451, 0.05881417564886515, 0.05329640406446012, 0.053691690708008055, 0.056106092699721444, 0.06923073003915392, 0.07159361626958316, 0.0811104342545017, 0.08893524458280755, 0.0959899610630468, 0.0883067437260201, 0.0913252750530813, 0.1121847249687824, 0.08310974968783902, 0.07929735890360656, 0.05718418598574715, 0.07010527979329217, 0.054565385865217975, 0.06090918428085579, 0.07221999025948977, 0.06967933868484533, 0.07249445617693473, 0.06757370528859785, 0.05930657461076194, 0.04196282151059205, 0.04567792557630357, 0.026699206298880007, 0.02726639106608908, 0.0384640085289667, 0.05440980396935213, 0.04795339571954438, 0.06035877908218645, 0.0583226228457181, 0.05336166590313396, 0.06813850796675891, 0.055203162954911456, 0.0744325804724757, 0.0861192637177044, 0.0898749613297789, 0.09996185135400637, 0.08943162534154814, 0.08378053317290557, 0.08772068554794132, 0.09128445257374684, 0.07545336105907952, 0.08044560481816476, 0.0784818221091872, 0.08844970765572002, 0.07900620754188137, 0.05521839825818686, 0.04354770970804145, 0.01099069438808531, 0.01614766181267635, 0.01320597516292743, 0.03163934274225899, 0.051819792059176084, 0.05829583136305572, 0.07873175661189058, 0.07628007993072794, 0.11128982795474074, 0.12409719613839121, 0.12394813193985832, 0.11125295619130826, 0.13320151640632893, 0.15287379343920215, 0.14423123409414962, 0.12972637052981728, 0.1335608355932405, 0.12696400959142662, 0.13834529032192133, 0.15885547062506733, 0.1534076913711202, 0.15305441681188592, 0.1435008800475388, 0.15309669961283223, 0.1649886811138308, 0.17003451292492056, 0.1810049441132584, 0.1720267252578438, 0.1758937616977363, 0.17145488913571927, 0.17055825083832343, 0.17141797435359907, 0.1638128240844885, 0.1768059568005822, 0.1741168505551285, 0.17790737514106847, 0.17424142840131007, 0.1734114593859888, 0.16434473282275208, 0.16908176441872658, 0.17153657255874855, 0.17732428312507453, 0.1753080238028204, 0.1759068238891759, 0.18418550731044459, 0.1728776185457528, 0.17980514507192558, 0.20003845955938737, 0.2066338912070933, 0.20613521138694457, 0.20303933166333787, 0.2090706592586078, 0.20975719807438398, 0.2123666528976802, 0.2063459266860519, 0.20931010005457273, 0.21735706948327493, 0.21575623329724958, 0.20668359995337404, 0.2066170417508224, 0.203953527537728, 0.18645808258648722, 0.19490303892603, 0.17376759053263213, 0.18098931156796594, 0.19597728859484143, 0.19888111229040017, 0.21204402870566574, 0.21719908830352241, 0.22741539487506812, 0.22731837599394722, 0.2278358002466936, 0.22748698772028808, 0.22917230797819355, 0.23032906297551925, 0.2356860583573086, 0.23091669409753535, 0.2303105694143508, 0.23250325348616063, 0.233978200207833, 0.24938904164489806, 0.22849306934676017, 0.209049998828285, 0.22854894637230427, 0.22293123669828918, 0.21904337756504644, 0.20644316599338164, 0.2324084640924171, 0.24354333096316405, 0.24610695566057061, 0.2667732524403901, 0.2725002581184255, 0.2836923652253809, 0.29257519089442563, 0.28999239495538465, 0.29714993789667576, 0.28656376067166156, 0.2803397895659383, 0.2873386398795761, 0.2757224623030765, 0.27490583486988407, 0.28222984111894545, 0.30141657146744105, 0.3066094487107758, 0.3015550997365992, 0.2972682585401236, 0.3008023829817068, 0.31877708086063317, 0.31539739024232905, 0.31724276534574924, 0.31728228429231, 0.3262782488120932, 0.32288842572416687, 0.3210695477335259, 0.3207002172187252, 0.32831059845119226, 0.3344719107584839, 0.3307388019300881, 0.32284022128281187, 0.3349925029688241, 0.3222661899684671, 0.3279304716529374, 0.3219087942439314, 0.32130404247283795, 0.3153427511505562, 0.3239020345595576, 0.3198129629322026, 0.3311612062838061, 0.3301173039159546, 0.3363133970541343, 0.34742840696170907, 0.3549731498438027, 0.35412851539561485, 0.3336328699025206, 0.3123455678481848, 0.32850372563077834, 0.3397656492989416, 0.3398386874173671, 0.3279466847091932, 0.3230347533426805, 0.3312660402815535, 0.3338684079825107, 0.34323546083226475, 0.33873648419859337, 0.3379850828738058, 0.3432777662598183, 0.34460925386080277, 0.34647664959707436, 0.34946243169248037, 0.3499252045285475, 0.35756189227154045, 0.3527613199644526, 0.351304422632593, 0.34522719535692215, 0.3489721221126545, 0.34941990825232305, 0.3474518048653148, 0.34642192069793487, 0.3359752798635933, 0.32698072465589956, 0.30470004391916206, 0.3269103064097436, 0.32898349547529326, 0.3254621520251122, 0.3369348443131095, 0.35056274426986733, 0.34486216789047375, 0.3419308084833277, 0.35054433848147015, 0.3547250353012992, 0.3601540931954703, 0.349724482872255, 0.3542792427139374, 0.34788971680417236, 0.364076990127447, 0.36809966398399974, 0.3637126049924093, 0.36384777448140393, 0.364001764633318, 0.3528484733514827, 0.3312862570703692, 0.348729135746354, 0.36112106759931994, 0.3622149349892898, 0.36783502602792706, 0.37351671809257225, 0.36916267524449764, 0.36469445350831986, 0.3695184793677653, 0.36531870991324, 0.36276743204932527, 0.37455363876309744, 0.3597667604500272, 0.3717907175444022, 0.3776004226012235, 0.3751548178801585, 0.383847988887454, 0.3930543550801251, 0.3936878401613164, 0.39522875721894746, 0.3991689529834852, 0.39245364253902126, 0.37558559698371186, 0.3766667997711306, 0.385024042889315, 0.3955388889307443, 0.3963164637889993, 0.3987378768315446, 0.3901543154724909, 0.3994433152592649, 0.4002607813117045, 0.40159577613425745, 0.39957190697316847]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31", "2021-09-01"], "y": [0.0, 0.005683615295595468, 0.022483488508018734, 0.007042880614752667, 0.012609610572875685, -0.004428214414652132, 0.013406151853049497, 0.012286734963228296, 0.03161038829255158, 0.03984167553123563, 0.038114441466162274, 0.03823485348997013, 0.03934048405313395, 0.045605565317833996, 0.05066974926796908, 0.03969396388881696, 0.024662837450496466, 0.027906368006272553, 0.02261444794385814, 0.02657487659808644, 0.015743370719563332, 0.014397022647386626, 0.023310890970770215, 0.0260033002935407, 0.03723968961217872, 0.04173377816413382, 0.04741160535594968, 0.061995710350011723, 0.057510389013283314, 0.06603173604475399, 0.059923463023505485, 0.06185463429176852, 0.06031337514179924, 0.05942182885072822, 0.054927132072273954, 0.0553048802717484, 0.058451767820105305, 0.07181562605761571, 0.07508086778686995, 0.08203989588488048, 0.09068006215684199, 0.09640942429749799, 0.09020121191431296, 0.09653714482277098, 0.11550069969598264, 0.08491489923302953, 0.08270368143931894, 0.055677344200199874, 0.0682958816907564, 0.05250326765500568, 0.057604498756028244, 0.06956671507219592, 0.06802689355647495, 0.07113156322274583, 0.06754751784273916, 0.05722166144910368, 0.03588632023946259, 0.04222722658716882, 0.022422863765988232, 0.02400537080972076, 0.03640645186397329, 0.05152166520341939, 0.04458620955026227, 0.05512247982255869, 0.054423848969282096, 0.05118048436450984, 0.0677612923301576, 0.05529093879500202, 0.07475525377437275, 0.08377337185607225, 0.0883682653934772, 0.09958775469545644, 0.0902945861903457, 0.08583174944453109, 0.08732978437377059, 0.08974904999809996, 0.0742965106487099, 0.07698383393777863, 0.07307584236842568, 0.08275413987741476, 0.07768210536134657, 0.05419495879070224, 0.04335771219089435, 0.009466812937231728, 0.01582727930993899, 0.013063264424522325, 0.028473665077797472, 0.048219519080724416, 0.05651100661268771, 0.07774177860798348, 0.0752241303398904, 0.12919170925793866, 0.1419904314976015, 0.14276435250725972, 0.12964051198951676, 0.1499554297997605, 0.17025292335847508, 0.15546645396523617, 0.1414784049152087, 0.14581299843140383, 0.13808486177148271, 0.155165877419428, 0.1745422004627819, 0.17013707420482316, 0.17026354679929145, 0.15934066650702405, 0.16873662460084748, 0.17562205767323258, 0.1802684404399879, 0.1922208575037201, 0.1831508852737267, 0.1875379055102504, 0.18227702129623258, 0.1826335186717285, 0.18334305440130483, 0.1739436238103622, 0.18771856783287322, 0.18382710483561926, 0.18867017028564015, 0.18333277565624106, 0.1819768939600528, 0.17392622998735208, 0.17835694858835294, 0.18099959218755157, 0.18821266628691435, 0.18557589607681502, 0.18763100481744033, 0.19709211088386236, 0.1811560233768157, 0.1866999584618716, 0.20360509433634388, 0.2143775515318993, 0.21587122319742313, 0.21442953328127023, 0.21886329256106318, 0.22111365034861818, 0.2239592667737238, 0.21380653755330248, 0.21567971414692022, 0.224167341150586, 0.22240850897320286, 0.21106233100316696, 0.20904474476571977, 0.2098686498216562, 0.18838721442675688, 0.20355630078583276, 0.1806472797248222, 0.1885543462725876, 0.2053669320199485, 0.20818667858831663, 0.22156923988879051, 0.22669809296352694, 0.23980266799394467, 0.23782760316276108, 0.23991003430881497, 0.24068173048750952, 0.24335700411938688, 0.24674321271472, 0.2519347223574635, 0.24654556174468123, 0.2492400633020846, 0.2523790431275459, 0.25326325976366415, 0.2649935931883256, 0.24314048692955015, 0.2246305797518644, 0.24615679566464355, 0.23855054041456158, 0.23563628672392256, 0.22269844605495615, 0.2456422454456415, 0.2582824158155652, 0.2616021591168862, 0.2792733825036824, 0.2848863726143467, 0.29280823480523255, 0.3055575980067369, 0.30149637471335766, 0.3082139956033316, 0.3000387995209657, 0.29470177470851033, 0.30165439524642745, 0.2902526499162099, 0.29147989178235334, 0.2981753054970797, 0.31571554171136085, 0.32064953315667655, 0.3152012320289146, 0.31409604302322136, 0.31961360957661444, 0.33652537117925063, 0.33264957299301434, 0.33537965653873236, 0.3352346074016328, 0.345145402522939, 0.34070005335051934, 0.33749158706982096, 0.33622742443497433, 0.34223646378696926, 0.34969438169870215, 0.3456655669585351, 0.33972946547436633, 0.35133416599867817, 0.337396111939414, 0.33960057190032056, 0.33754238131672154, 0.33632289700464857, 0.3312887159539408, 0.33914067746404664, 0.3328306350017456, 0.34099519893778507, 0.3404599585460446, 0.3445677420123403, 0.35815810048640095, 0.36847465041062444, 0.3696087688419962, 0.35233997526914296, 0.326924449792948, 0.344487547522927, 0.35766964752056984, 0.3564362577990694, 0.34762409591960397, 0.343034078378333, 0.3504325670729349, 0.3529918208854932, 0.3631655050219291, 0.3589374638599492, 0.3573756581729728, 0.35906378656352067, 0.35974241962002074, 0.35895365185624817, 0.36369994934421346, 0.3621135337236385, 0.3709514803094849, 0.366957598811237, 0.36467546397775186, 0.35879478288814703, 0.365167663751401, 0.3664087848382733, 0.36183612202767024, 0.35788989116587344, 0.349060859511648, 0.34084002500568933, 0.31729444303342236, 0.33923920767882043, 0.34095068695150643, 0.3386843871900347, 0.35111190016259, 0.36140407795371443, 0.3548952499701421, 0.3541985954251139, 0.36149297240677014, 0.36570891489191437, 0.3710220558765749, 0.3623516334391703, 0.3667990925371476, 0.35809723482359757, 0.37601475204075996, 0.3824818879405971, 0.3789848045549318, 0.38149263407410605, 0.3811101428456476, 0.37259023287680515, 0.3465148592855869, 0.36503324695070294, 0.37537885390572767, 0.3771499241924452, 0.3827291319460213, 0.3882659008748426, 0.3834949183433556, 0.3784411995270476, 0.3837094277575417, 0.3769792700122967, 0.37493474153511697, 0.3859859813598916, 0.372834558400988, 0.3825031057786521, 0.38593167619702995, 0.38299058112386364, 0.38918668902173525, 0.39765735992559925, 0.3991535231608212, 0.400510175257369, 0.4038503413860628, 0.39229910459481054, 0.37745138145945023, 0.3744899034833369, 0.38354778903569353, 0.394672383133573, 0.3958801181231315, 0.3979954015393783, 0.39121320557210115, 0.39956370404486585, 0.3978777674520524, 0.39790193305459143, 0.3959762433536236]}],
                        {"font": {"size": 15}, "height": 900, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 16}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Cumulative Return of A2C & PPO against DJIA", "x": 0.48, "xanchor": "center", "y": 0.92, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Cumulative Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('b78e4db3-d900-4251-a255-017215c9e7cc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

</div>


</body>
  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="LearnableLoopAI/portfolio"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/portfolio/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/portfolio/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/portfolio/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/portfolio/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Portfolio of Data Science Projects</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/LearnableLoopAI" title="LearnableLoopAI"><svg class="svg-icon grey"><use xlink:href="/portfolio/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/portfolio/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
